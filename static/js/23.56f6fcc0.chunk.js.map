{"version":3,"sources":["views/Hedging/HedgingTable.tsx","views/Hedging/index.tsx","hooks/useHashPowerToken.ts","utils/formatTheValue.ts"],"names":["HedgeButton","styled","_templateObject","_taggedTemplateLiteral","PositionTag","_templateObject2","LongTag","_templateObject3","ShortTag","_templateObject4","TableWrapper","_templateObject5","TableHeader","_templateObject6","TableItem","_templateObject7","TableBody","_templateObject8","TableCell","_templateObject9","ChildTable","_templateObject10","ChildTabelCell","_templateObject11","HedingTable","props","testData","openTableItem","setOpenTableItem","useState","_jsxs","children","_jsx","className","onClick","length","console","log","Array","from","_","index","AddIcon","style","transform","color","map","item","concat","includes","exists","some","items","filter","src","TokensIcon","ticker","display","marginRight","float","alt","markPrice","formatNumber","walletBalance","avatarBalance","outstandingDebt","balanceCollateral","childTableInfo","childItem","deliveryDate","fairPrice","number","netPosition","Number","toLargeUnits","toString","replace","paddingRight","window","open","actionUrl","HedgingBox","HedgingPage","hedgingInfo","active","library","chainId","account","useWeb3React","walletTokenBalance","useHashPowerToken","observerContract","signer","useSystemParams","positionAll","tokenPrice","allowedTokens","usePositionInfo","setHedgingInfo","getPositionVal","useCallback","async","instrumentAddress","result","res","getPosition","size","error","getFairPrice","instrument","inquire","sqrtFairPX96","getExpiries","positionInfo","txInfo","childTable","i","_deliveryDate","_positionVal","mintTokenInfo","_fairPrice","push","moment","format","toFixed","settlementCurrency","decimals","hedgingVersion","initData","isSupportedChainId","postionInfo","Object","values","_instrument","ethers","Contract","InstrumentABI","_avatarAssetList","keys","valueToKeyMap","reduce","acc","key","_tokenPrice$postionIn","isEnable","positionAddress","symbol","price","balances","tokens","tokenInfoData","logo","displayMarkPrice","TokenUtils","formatFourDecimals","balance","state","e","useEffect","useHedging","Title","Card","paddingTop","paddingLeft","overflow","height","HedgingTable","hashPowerToken","useContext","HashPowerTokenContext","undefined","Error","formatNumberWithUnits","val","resVal","formatSnNumber","isNaN","toLocaleString","String","rex","test","numArr","match","n","substr","mark","value","slice","indexOf","formatWBTC","BigNumber","pow","WBTC","decimal","arguments","v","str","formatTokenAmount"],"mappings":"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","file":"static/js/23.56f6fcc0.chunk.js","sourcesContent":["import React, { useCallback, useState } from 'react'\nimport { styled } from '@mui/material/styles'\nimport { TokensIcon } from 'config/constants/tokens'\nimport { toLargeUnits } from 'utils/transformHelper'\nimport { formatNumber } from 'utils/formatTheValue'\nimport AddIcon from '../../components/uikit/components/Svg/Icons/Add'\n\nconst HedgeButton = styled('div')`\n  padding: 2px 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-family: Inter;\n  font-size: 12px;\n  font-weight: 500;\n  line-height: 20px;\n  letter-spacing: 0.02em;\n  border-radius: 20px;\n  background: linear-gradient(90deg, #61c2f7 0%, #7ae9f0 100%);\n  cursor: pointer;\n`\n\nconst PositionTag = styled('div')`\n  font-family: PingFang SC;\n  font-size: 10px;\n  font-weight: 500;\n  line-height: 10px;\n  padding: 4px 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 12px;\n  margin-right: 8px;\n`\n\nconst LongTag = styled(PositionTag)`\n  color: rgba(85, 181, 89, 1);\n  background: rgba(85, 181, 89, 0.1);\n`\n\nconst ShortTag = styled(PositionTag)`\n  color: rgba(237, 112, 107, 1);\n  background: rgba(237, 112, 107, 0.2);\n`\n\nconst TableWrapper = styled('div')`\n  min-width: 946px;\n  .active-icons {\n    transform: rotate(45deg);\n  }\n  .active-table {\n    background-color: white;\n    border-radius: 8px 8px 0 0;\n    border-bottom: unset;\n  }\n  .active-child-table {\n    height: auto;\n  }\n  .icons {\n    margin-right: 17px;\n    line-height: 19.6px;\n    /* transform-origin: center center; */\n    width: 20px;\n    margin-left: 12px;\n    cursor: pointer;\n  }\n  .ticker {\n    text-align: left;\n    width: 159px;\n  }\n  .price {\n    width: 184px;\n  }\n  .balance-wallet {\n    width: 195px;\n  }\n  .balance-collateral {\n    width: 216px;\n  }\n  .debt {\n    width: 196px;\n    margin-left: auto;\n    padding-right: 11px;\n  }\n`\n\nconst TableHeader = styled('div')`\n  display: flex;\n  color: #00000080;\n  padding: 18px 0;\n  border-bottom: 0.5px solid #0000001f;\n  font-size: 14px;\n`\n\nconst TableItem = styled('div')`\n  font-family: PingFang SC;\n  font-weight: 400;\n  line-height: 19.6px;\n  text-align: right;\n  display: flex;\n  align-items: center;\n`\nconst TableBody = styled('div')``\n\nconst TableCell = styled('div')`\n  color: #000000;\n  font-family: PingFang SC;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 19.6px;\n  padding: 17px 0;\n  border-bottom: 0.5px solid #0000001f;\n  margin-top: 10px;\n  cursor: pointer;\n  display: flex;\n`\n\nconst ChildTable = styled('div')`\n  background: #def1ff;\n  border-radius: 0 0 8px 8px;\n  overflow: hidden;\n  height: 0;\n  padding: 0 30px 0 50px;\n  .debt {\n    padding-right: 20px;\n    display: flex;\n    justify-content: end;\n  }\n`\nconst ChildTabelCell = styled(TableCell)`\n  font-size: 12px;\n  padding: 11px 0 12px;\n  align-items: center;\n  border-bottom: 0.5px solid #0000001f;\n  &:last-of-type {\n    border: unset;\n  }\n`\n\ninterface Props {\n  testData: any[]\n}\n\nconst tagStatus = (number: any) => {\n  // console.log(number, 'number')\n\n  if (number === 0) {\n    return ''\n  }\n  return Number(number) > 0 ? <LongTag>Long</LongTag> : <ShortTag>Short</ShortTag>\n}\n\nfunction HedingTable(props: Props) {\n  const { testData } = props\n  const [openTableItem, setOpenTableItem] = useState([0])\n\n\n\n  return (\n    <TableWrapper>\n      <TableHeader>\n        <TableItem\n          className=\"icons\"\n          onClick={() => {\n            if (openTableItem.length === testData.length) {\n              setOpenTableItem([])\n            } else {\n              console.log(Array.from({ length: testData.length }, (_, index) => index))\n              setOpenTableItem(Array.from({ length: testData.length }, (_, index) => index))\n            }\n          }}\n        >\n          <AddIcon\n            style={{\n              transform: openTableItem.length === testData.length ? 'rotate(45deg)' : '',\n            }}\n            color=\"#2AA1FF\"\n          />\n        </TableItem>\n        <TableItem className=\"ticker\">Ticker</TableItem>\n        <TableItem className=\"price\">Mark Price</TableItem>\n        <TableItem className=\"balance-wallet\">Balance in Wallet</TableItem>\n        <TableItem className=\"balance-collateral\">Balance in Collateral</TableItem>\n        <TableItem className=\"debt\">Outstanding Debt</TableItem>\n      </TableHeader>\n\n      {testData &&\n        testData.length > 0 &&\n        testData.map((item, index) => (\n          <TableBody key={item.balanceCollateral}>\n            <TableCell\n              key={item.balanceCollateral}\n              className={`${openTableItem.includes(index) ? 'active-table' : ''}`}\n              onClick={() => {\n                const exists = openTableItem.some((items) => items === index)\n\n                if (exists) {\n                  setOpenTableItem(openTableItem.filter((items) => items !== index))\n                } else {\n                  setOpenTableItem([...openTableItem, index])\n                }\n              }}\n            >\n              <TableItem className={`${openTableItem.includes(index) ? 'active-icons' : ''} icons`}>\n                <AddIcon color=\"#2AA1FF\" />\n              </TableItem>\n              <TableItem className=\"ticker\">\n                <img\n                  src={TokensIcon[item.ticker]}\n                  style={{ display: 'block', marginRight: 7, float: 'left' }}\n                  alt=\"icon\"\n                />\n                {item.ticker}\n              </TableItem>\n              <TableItem className=\"price\">\n                {item.markPrice} {' WBTC'}\n              </TableItem>\n              <TableItem className=\"balance-wallet\">{formatNumber(item.walletBalance)}</TableItem>\n              <TableItem className=\"balance-collateral\">{formatNumber(item.avatarBalance)}</TableItem>\n              <TableItem className=\"debt\">{formatNumber(item.outstandingDebt)}</TableItem>\n            </TableCell>\n            <ChildTable className={`${openTableItem.includes(index) ? 'active-child-table' : ''}`}>\n              <TableHeader>\n                <TableItem className=\"ticker\">Delivery Date</TableItem>\n                <TableItem className=\"price\">Fair Price</TableItem>\n                <TableItem className=\"balance-wallet\">Net Position</TableItem>\n                <TableItem className=\"balance-collateral\" />\n                <TableItem className=\"debt\">Action</TableItem>\n              </TableHeader>\n\n              {item.childTableInfo &&\n                item.childTableInfo.length > 0 &&\n                item.childTableInfo.map((childItem) => (\n                  <ChildTabelCell className=\"child-table-cell\" key={childItem.deliveryDate}>\n                    <TableItem className=\"ticker\">{childItem.deliveryDate}</TableItem>\n                    <TableItem className=\"price\">\n                      {formatNumber(childItem.fairPrice)} {' WBTC'}\n                    </TableItem>\n                    <TableItem className=\"balance-wallet\">\n                      {/* {childItem.netPosition} */}\n                      {tagStatus(childItem.netPosition)}{' '}\n                      {formatNumber(toLargeUnits(childItem.netPosition.toString(), 18).toString().replace(/^[-+]/, ''))}\n                    </TableItem>\n                    <TableItem className=\"balance-collateral\" />\n                    <TableItem\n                      className=\"debt\"\n                      style={{\n                        paddingRight: '7px',\n                      }}\n                    >\n                      <HedgeButton\n                        onClick={() => {\n                          window.open(`${childItem.actionUrl}`)\n                        }}\n                      >\n                        Hedge\n                      </HedgeButton>\n                    </TableItem>\n                  </ChildTabelCell>\n                ))}\n            </ChildTable>\n          </TableBody>\n        ))}\n    </TableWrapper>\n  )\n}\nexport default HedingTable\n","import React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport { styled } from '@mui/material/styles'\nimport Card from 'components/Card'\nimport useSystemParams from 'hooks/useSystemParams'\nimport { useWeb3React } from 'web3-react-core'\nimport useToast from 'hooks/useToast'\nimport { useGetTokenBalance } from 'hooks/useManager'\nimport { TokenUtils, toLargeUnits, toSmallUnits } from 'utils/transformHelper'\nimport { Title } from 'components/CommonComponent'\nimport { formatWBTC } from 'utils/formatTheValue'\nimport moment from 'moment'\nimport { hedgingVersion } from 'config/constants/contants'\nimport { usePositionInfo } from 'hooks/news/usePoistion'\nimport useHashPowerToken from 'hooks/useHashPowerToken'\nimport { Contract, ethers } from 'ethers'\nimport InstrumentABI from 'config/abi/instrument.json'\n// eslint-disable-next-line import/order\nimport HedgingTable from './HedgingTable'\nimport { SupportedTokens, valueToKeyMap } from 'config/constants/tokenConfig'\nimport { Position } from 'state/MintToken/type'\nimport { isSupportedChainId } from 'utils/web3React'\nimport { uniq } from 'lodash'\n\nconst HedgingBox = styled('div')`\n  width: 100%;\n  height: 100%;\n  padding-right: 100px;\n  overflow: auto;\n`\n\nfunction useHedging() {\n  const { active, library, chainId, account } = useWeb3React()\n\n  const { walletTokenBalance } = useHashPowerToken()\n  // const [markPrice, setMarkPrice] = useState(0)\n  const { observerContract, signer } = useSystemParams()\n\n  const { positionAll, tokenPrice, allowedTokens } = usePositionInfo()\n\n  const [hedgingInfo, setHedgingInfo] = useState<any>({})\n  // useEffect(() => {\n  //   queryMarkPrice()\n  // }, [queryMarkPrice])\n\n  const getPositionVal = useCallback(\n    async (instrumentAddress: string, deliveryDate: string) => {\n      let result = 0\n      try {\n        const res = await observerContract.getPosition(instrumentAddress, deliveryDate, account)\n        if (res && res.size) {\n          result = res.size\n        }\n      } catch (error) {\n        console.error('getPositionVal error', error)\n      }\n      return result\n    },\n    [account, observerContract],\n  )\n\n  const getFairPrice = useCallback(async (instrument, deliveryDate: string) => {\n    let result = 0\n    try {\n      const res = await instrument.inquire(deliveryDate, 0)\n      if (res && res.sqrtFairPX96) {\n        // TODO\n        result = Number(res.sqrtFairPX96 / 2 ** 96) ** 2\n      }\n    } catch (error) {\n      console.error('getFairPrice error', error)\n    }\n    return result\n  }, [])\n\n  const getExpiries = useCallback(\n    async (positionInfo: Position, instrument: Contract) => {\n      try {\n        const txInfo = await instrument.getExpiries()\n        if (txInfo) {\n          const childTable = []\n\n          for (let i = 0; i < txInfo.length; i++) {\n            const _deliveryDate = txInfo[i]\n            const _positionVal = await getPositionVal(positionInfo.mintTokenInfo.instrument, _deliveryDate)\n            const _fairPrice = await getFairPrice(instrument, _deliveryDate)\n            childTable.push({\n              deliveryDate: moment(_deliveryDate * 1000).format('YYYY-MM-DD'),\n              fairPrice: _fairPrice.toFixed(positionInfo.mintTokenInfo.settlementCurrency.decimals),\n              netPosition: Number(_positionVal),\n              actionUrl: `https://testnet.synfutures.com/#/trade/blastsepolia/F(BTC,25)-WBTC-${hedgingVersion}-${moment(\n                _deliveryDate * 1000,\n              ).format('MMDD')}`,\n            })\n          }\n          return childTable\n        }\n        return []\n      } catch (error) {\n        console.error('getExpiries error', error)\n        throw error\n      }\n    },\n    [getFairPrice, getPositionVal],\n  )\n\n  const initData = useCallback(async () => {\n    if (chainId && isSupportedChainId(chainId)) {\n      for (const postionInfo of Object.values(positionAll)) {\n        // console.log('first', first)\n        const _instrument = new ethers.Contract(postionInfo.mintTokenInfo.instrument, InstrumentABI, signer)\n        let markPrice = 0\n        const { settlementCurrency } = postionInfo.mintTokenInfo\n        let _avatarAssetList = Object.keys(valueToKeyMap).reduce((acc, key) => {\n          return {\n            ...acc,\n            [key]: 0,\n          }\n        }, {}) as Record<SupportedTokens, number>\n        if (postionInfo.isEnable && tokenPrice[postionInfo.positionAddress]) {\n          markPrice = toLargeUnits(\n            tokenPrice[postionInfo.positionAddress][postionInfo.mintTokenInfo.symbol]?.price,\n            settlementCurrency.decimals,\n            true,\n          ) as number\n        }\n        if (postionInfo.isEnable && allowedTokens[postionInfo.positionAddress]) {\n          const { balances, tokens } = allowedTokens[postionInfo.positionAddress]\n          if (balances && tokens) {\n            _avatarAssetList = Object.keys(balances).reduce(\n              (acc, key) => {\n                return {\n                  ...acc,\n                  [key]: toLargeUnits(balances[key], tokens[key].decimals, true) as number,\n                }\n              },\n              {\n                ..._avatarAssetList,\n              },\n            )\n          }\n        }\n        const tokenInfoData = {\n          ticker: postionInfo.mintTokenInfo.symbol,\n          logo: postionInfo.mintTokenInfo.logo,\n          markPrice,\n          displayMarkPrice: `${markPrice} ${settlementCurrency.symbol}`,\n          walletBalance: Number(TokenUtils.formatFourDecimals(walletTokenBalance[postionInfo.mintTokenInfo.symbol])),\n          avatarBalance: Number(_avatarAssetList[postionInfo.mintTokenInfo.symbol]),\n          mintTokenInfo: postionInfo.mintTokenInfo,\n          isEnable: postionInfo.isEnable,\n          positionAddress: postionInfo.positionAddress,\n          outstandingDebt: Number(\n            TokenUtils.formatFourDecimals(\n              toLargeUnits(postionInfo.balance, postionInfo.mintTokenInfo.decimals, true) as number,\n            ),\n          ),\n          childTableInfo: [],\n        }\n        console.log('tokenInfoData', tokenInfoData)\n        try {\n          const childTableInfo = await getExpiries(postionInfo, _instrument)\n          console.log('childTableInfo', childTableInfo)\n          tokenInfoData.childTableInfo = childTableInfo\n          setHedgingInfo((state) => {\n            return {\n              ...state,\n              [postionInfo.mintTokenInfo.symbol]: tokenInfoData,\n            }\n          })\n        } catch (e) {\n          console.error('getExpiries error', e)\n          setHedgingInfo(tokenInfoData)\n        }\n      }\n    }\n  }, [allowedTokens, chainId, getExpiries, positionAll, signer, tokenPrice, walletTokenBalance])\n\n  useEffect(() => {\n    // getExpiries()\n    initData()\n  }, [initData])\n\n  return {\n    hedgingInfo,\n  }\n}\n\nfunction HedgingPage() {\n  const { hedgingInfo } = useHedging()\n\n  return (\n    <HedgingBox>\n      <Title>Hedging</Title>\n      <Card\n        style={{\n          paddingTop: '15px',\n          paddingLeft: '20px',\n          paddingRight: '20px',\n          overflow: 'auto',\n          height: 'calc(100% - 200px)',\n        }}\n      >\n        <HedgingTable testData={Object.values(hedgingInfo)} />\n      </Card>\n    </HedgingBox>\n  )\n}\n\nexport default HedgingPage\n","import { useContext } from 'react'\nimport {HashPowerTokenContext} from \"contexts\";\n\nconst useHashPowerToken = () => {\n  const hashPowerToken = useContext(HashPowerTokenContext)\n\n  if (hashPowerToken === undefined) {\n    throw new Error('hashPowerToken context undefined')\n  }\n\n  return hashPowerToken\n}\n\nexport default useHashPowerToken\n","import { BigNumber } from '@ethersproject/bignumber'\nimport tokens from 'config/constants/tokens'\nimport { utils } from 'ethers'\nimport { TokenUtils } from './transformHelper'\n\n// TODO  formatCurrency => formatNumberWithUnits\nexport function formatNumberWithUnits(val) {\n  if (val >= 1000000) {\n    return `${(val / 1000000).toFixed(1)}M`\n  }\n  if (val >= 10000) {\n    return `${(val / 1000).toFixed(1)}K`\n  }\n  const resVal = val.toFixed(2)\n  if (resVal === 0 || resVal === '0') {\n    return '0.00'\n  }\n  return resVal\n}\n\n// TODO rewrite\nexport function formatSnNumber(number) {\n  if (Number.isNaN(Number(number))) {\n    return number\n  }\n\n  if (number.toString().includes('+')) {\n    return Number(number).toLocaleString().replace(/,/g, '')\n  }\n  if (String(number).includes('-')) {\n    const e = String(number)\n    const rex = /^([0-9]).?([0-9]*)e-([0-9]*)/\n    if (!rex.test(e)) return number\n    const numArr = e.match(rex)\n    const n = Number(`${numArr[1]}${numArr[2] || ''}`)\n    const num = `0.${String(10 ** (Number(numArr[3]) - 1)).substr(1)}${n}`\n    return num.replace(/0*$/, '')\n  }\n\n  return String(number).includes('.') ? TokenUtils.formatFourDecimals(Number(number)) : String(number)\n}\n\nexport default function formatTheValue(val: number | BigNumber | any, unitName?: number) {\n  return Number(utils.formatUnits(typeof val === 'number' ? val.toFixed(unitName) : val, unitName))\n  // return 0\n}\n// TODO reset\nexport function toFixed(val, mark?) {\n  const value = String(formatSnNumber(val))\n  if (mark && mark === 'WBTC' && Number(value) && value.includes('.')) {\n    return formatSnNumber(Number(value.slice(0, value.indexOf('.') + 9)))\n  }\n  if (mark && mark === 'F(BTC,20)' && Number(value) && value.includes('.')) {\n    return formatSnNumber(Number(value.slice(0, value.indexOf('.') + 7)))\n  }\n  if (typeof mark === 'number') {\n    return formatSnNumber(Number(value.slice(0, value.indexOf('.') + (mark + 1))))\n  }\n  if (mark !== 'WBTC' || mark !== 'F(BTC,20)') {\n    if (value.includes('.')) {\n      return formatSnNumber(Number(value.slice(0, value.indexOf('.') + 3)))\n    }\n    return val\n  }\n  return val\n}\n\nexport function formatWBTC(val) {\n  if (val) {\n    return toFixed(formatSnNumber(val / Number(BigNumber.from(10).pow(tokens.WBTC.decimals))), 'WBTC')\n  }\n  // if (val) {\n  //   return toSmallUnits(val.toSring(), tokens.WBTC.decimals) as any\n  // }\n  return 0\n}\n\nexport function formatBalance(val, mark) {\n  if (val) {\n    return toFixed(formatSnNumber(val / Number(BigNumber.from(10).pow(tokens.WBTC.decimals))), mark)\n  }\n  return 0\n}\n\nexport function toWBTC(val) {\n  return formatSnNumber(val * 10 ** 8)\n}\nexport function toHashToken(val) {\n  return formatSnNumber(val * 10 ** 6)\n}\n\nexport function formatInfinity(val) {\n  const value = String(val)\n  if (value && value.includes('Infinity') && value.includes('-')) {\n    return '-∞'\n  }\n  if (value && value.includes('Infinity') && !value.includes('-')) {\n    return '+∞'\n  }\n\n  return typeof val === 'number' && String(val).includes('.') ? val.toFixed(2) : val\n}\n\nexport function formatNumber(val: any, decimal = 4) {\n  if (val === undefined) {\n    return '0'\n  }\n\n  const v = typeof val === 'number' ? val : Number(val)\n  const str = String(v)\n  return str.includes('.') ? TokenUtils.formatTokenAmount(val, decimal) : str\n}\n"],"sourceRoot":""}