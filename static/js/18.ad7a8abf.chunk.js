(this["webpackJsonpmappingfunk-interface"]=this["webpackJsonpmappingfunk-interface"]||[]).push([[18],{1043:function(e,t,n){"use strict";n.r(t);var a,o,i,r,l,c,s,d,b,u,p,j=n(8),x=n(1),m=n(1057),h=n(76),g=n(46),f=n(412),O=n(217),v=n(25),y=n(434),k=n(213),w=n(37),C=n(21),T=n(14),I=n(140),A=n(12),S=n(51),z=n(425),M=n(107),N=n(405),P=n(1050);const F=Object(g.a)(N.a)(a||(a=Object(j.a)(["\n  height: 32px;\n  padding: 0 16px;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 32px;\n  border-radius: 20px;\n  text-transform: none;\n  color: rgba(0, 0, 0, 1);\n  background: linear-gradient(90deg, rgba(97, 194, 247, 1) 0%, rgba(122, 233, 240, 1) 100%);\n"]))),E=Object(g.a)("div")(o||(o=Object(j.a)(["\n  .MuiSlider-markLabel {\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n    }\n  }\n"]))),R=Object(g.a)("div")(i||(i=Object(j.a)(["\n  position: relative;\n  width: 100%;\n\n  .custom_range_flag {\n    font-size: 12px;\n    transform: translateX(-50%);\n    position: absolute;\n    top: 6px;\n    left: ",";\n    height: 24px;\n    width: fit-content;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    border-radius: 23px;\n    padding: 0 5px;\n    line-height: 24px;\n    &::before {\n      position: absolute;\n      content: '';\n      left: 2px;\n      top: 2px;\n      right: 2px;\n      bottom: 2px;\n      background-color: #fff;\n      border-radius: 20px;\n    }\n    .range_val {\n      position: relative;\n      z-index: 1;\n    }\n  }\n  &.feature_item {\n    .custom_range_flag {\n      top: -26px;\n    }\n  }\n"])),(e=>e.value>300||"+\u221e"===e.value?"calc(100% - 5%)":"calc((100% - 5%) / 300 * ".concat(e.value,")"))),D=Object(g.a)(P.a)(r||(r=Object(j.a)(["\n  height: 10px;\n  width: 95%;\n\n  .MuiSlider-valueLabel:before {\n    display: none;\n  }\n  .MuiSlider-valueLabel {\n    height: 24px;\n    width: 36px;\n    font-size: 12px;\n    background-color: #fff;\n    border-radius: 20px;\n    border: 2px solid #61c2f7;\n    color: #000;\n    transform: translate(0, 10px) !important;\n  }\n  .MuiSlider-rail {\n    background: rgba(212, 230, 242, 1);\n  }\n\n  .MuiSlider-track {\n    border: none;\n    background: linear-gradient(-90deg, #8cdb65, #ffcc04 40%, #ff6308);\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n    height: 24px;\n    width: 24px;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    &:focus,\n    &:hover,\n    &.Mui-active,\n    &.Mui-focusVisible {\n      box-shadow: inherit;\n    }\n\n    &::before {\n      background-color: #fff;\n      width: 20px;\n      height: 20px;\n      left: calc(50% - 10px);\n      top: calc(50% - 10px);\n    }\n    &::after {\n      content: '';\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      background: #2aa1ff;\n      box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    }\n  }\n\n  .MuiSlider-mark {\n    &[data-index='0'] {\n      opacity: 0;\n    }\n    &[data-index='3'] {\n      display: none !important;\n    }\n\n    top: 5px;\n    height: 7.5px;\n    background-color: #969696;\n  }\n\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='0'] {\n      left: 10px !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n    }\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n  }\n"]))),V=Object(g.a)(P.a)(l||(l=Object(j.a)(["\n  height: 10px;\n  width: 95%;\n  margin-top: -30px;\n  transition: all 0.3s ease;\n  .css-1kz0hui-MuiSlider-valueLabel:before {\n    display: none;\n  }\n  .css-1kz0hui-MuiSlider-valueLabel {\n    height: 24px;\n    width: 36px;\n    font-size: 12px;\n    background-color: #fff;\n    border-radius: 20px;\n    border: 2px solid #61c2f7;\n    color: #000;\n    transform: translate(0, 10px);\n  }\n  .MuiSlider-rail {\n    background: rgba(212, 230, 242, 1);\n  }\n\n  .MuiSlider-track {\n    border: none;\n    background: linear-gradient(-90deg, #8cdb65, #ffcc04 40%, #ff6308);\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n    height: 24px;\n    width: 24px;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    &:focus,\n    &:hover,\n    &.Mui-active,\n    &.Mui-focusVisible {\n      box-shadow: inherit;\n    }\n\n    &::before {\n      background-color: #fff;\n      width: 20px;\n      height: 20px;\n      left: calc(50% - 10px);\n      top: calc(50% - 10px);\n    }\n\n    &::after {\n      content: '';\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      background: #2aa1ff;\n      box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    }\n  }\n  .MuiSlider-mark {\n    display: none !important;\n  }\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='0'] {\n      left: 10px !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n      color: rgba(0, 0, 0, 1) !important;\n    }\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n  }\n"]))),L=Object(g.a)(P.a)(c||(c=Object(j.a)(["\n  padding-bottom: 20px;\n  padding-top: 10px;\n  margin-top: -20px;\n  height: 0;\n  width: 95%;\n\n  .MuiSlider-rail {\n    display: none;\n  }\n\n  .MuiSlider-track {\n    display: none;\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n  }\n\n  .MuiSlider-mark {\n    display: none;\n  }\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='2'] {\n      font-weight: bold;\n      color: rgba(0, 0, 0, 1) !important;\n    }\n  }\n"]))),B={display:"flex",justifyContent:"space-between",alignItems:"start"},H=Object(g.a)(M.a)(s||(s=Object(j.a)(["\n  margin-bottom: 20px;\n  display: block;\n  width: 58%;\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),W=Object(g.a)(M.a)(d||(d=Object(j.a)(["\n  margin-bottom: 20px;\n  display: flex;\n  width: 40%;\n  /* opacity */\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),U=Object(g.a)("div")(b||(b=Object(j.a)(["\n  width: 100%;\n  input {\n    width: 100%;\n    border: unset;\n    outline: unset;\n    background-color: unset;\n    font-family: PingFang SC;\n    font-size: 24px;\n    font-weight: 600;\n    line-height: 33.6px;\n    text-align: left;\n    color: rgba(0, 0, 0, 1);\n  }\n  input::-webkit-inner-spin-button {\n    display: none;\n  }\n  input::placeholder {\n    color: rgba(0, 0, 0, 0.2);\n  }\n"]))),_={tableHeader:{fontSize:12,fontWeight:500,color:"rgba(0, 0, 0, 0.6)"},tableHeadCell:{pl:0,pr:0,pb:0},tableBody:{borderBottom:"1px solid rgba(47, 0, 0, 0.13)"},tableBodyRow:{"&:last-child td, &:last-child th":{border:0},transition:"all 0.3s",":hover":{backgroundColor:"rgba(110, 214, 243, 0.13)"}},tableBodyCell:{display:"flex",alignItems:"center",pl:1,pr:0,height:66,cursor:"pointer"},clearAll:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"}},Z={box:{width:"100%",overflow:"hidden",overflowX:"scroll","&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-track:hover":{backgroundColor:"#f1f1f1"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},topBox:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:3}},Y={addAdnRemoveBtn:{color:"#000",width:32,height:32,background:"linear-gradient(90deg, #29A0FF 0%, #7AE8F1 100%)",backgroundSize:"100% 100%"}},X=Object(g.a)("div")(u||(u=Object(j.a)(["\n  display: flex;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.03);\n  border-radius: 8px;\n  padding: 16px 20px;\n  margin-top: 10px;\n  p {\n    line-height: 20px;\n    font-size: 14px;\n    font-family: PingFangSC-Regular, sans-serif;\n    margin-left: 16px;\n    color: rgba(0, 0, 0, 0.5);\n  }\n"]))),q=Object(g.a)("div")(p||(p=Object(j.a)(["\n  margin-top: 34px;\n  .title-neutralize {\n    font-size: 16px;\n    font-family: PingFangSC-Medium, sans-serif;\n    margin-bottom: 16px;\n    font-size: 500;\n  }\n  .content {\n    display: flex;\n  }\n  .item_wrap {\n    min-width: 200px;\n    padding: 1px;\n    border-radius: 14px;\n    overflow: hidden;\n    margin-right: 16px;\n    background: #e3e8ed;\n    cursor: pointer;\n    user-select: none;\n    span {\n      font-family: PingFangSC-Regular, sans-serif;\n      color: rgba(0, 0, 0, 0.5);\n      font-size: 12px;\n      line-height: 17px;\n      &:first-of-type {\n        margin-right: 30px;\n      }\n    }\n    &.active {\n      padding: 2px;\n      background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n      span {\n        color: #000;\n      }\n    }\n  }\n  .item {\n    border-radius: 12px;\n    //border: 2px solid #E3E8ED;\n    //border-image: linear-gradient(#7AE9F0 , #61C3F7) 30 30;\n    padding: 14px 14px 9px 10px;\n    background: #fff;\n    width: 100%;\n    height: 100%;\n    //box-sizing: border-box;\n    h4 {\n      font-family: PingFangSC-Semibold, sans-serif;\n      font-weight: 550;\n      display: flex;\n      align-items: center;\n      line-height: 20px;\n      font-size: 14px;\n      margin-bottom: 22px;\n      svg {\n        margin-right: 8.5px;\n      }\n    }\n    p {\n      display: flex;\n      justify-content: space-between;\n    }\n  }\n"])));var G,J,K,$,Q,ee,te,ne,ae,oe=n(0);function ie(e){const{value:t}=e,[n,a]=Object(x.useState)({rate:0,coverage:0});Object(x.useEffect)((()=>{t&&(null!==t&&void 0!==t&&t.marks1&&(null===t||void 0===t?void 0:t.marks1.length)>0?a({rate:null===t||void 0===t?void 0:t.defaultvalue,coverage:0}):a({rate:0,coverage:null===t||void 0===t?void 0:t.defaultvalue}))}),[t]);const o=Object(x.useCallback)((e=>{let t=e;return"Infinity"===t||t===1/0||"+\u221e"===t?"+\u221e":(t=Number(t),0!==t&&t?t&&-1!==t.toString().indexOf("%")?"".concat(t.replace(/%/g,""),"%"):"".concat(t,"%"):0)}),[]),i=Object(x.useMemo)((()=>{const e=n.coverage;return"Infinity"===e||e===1/0||"+\u221e"===e?"+\u221e":0!==e&&e?"".concat(e):0}),[n.coverage]),r=Object(x.useMemo)((()=>{const e="Infinity"===n.coverage||"N/A"===n.coverage||n.coverage===1/0||"+\u221e"===n.coverage||"NAN"===n.coverage.toString()||Number(n.coverage)>300?300:Number(n.coverage),t=e>0?e:0,a=t<=10?11*t:6*(t-10)+100,o="Infinity"===n.rate||n.rate===1/0||"+\u221e"===n.rate||"NAN"===n.rate.toString()||Number(n.rate)>300?300:n.rate,i=Number(o)>0?o:0;return{rate:Number(i)<=110?Number(i):3*(Number(i)-100)+100,coverage:a}}),[n.coverage,n.rate]);return Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)("div",{className:"range_wrap",children:[Object(oe.jsx)(E,{className:"custom-slider-wrapper",children:Object(oe.jsx)(L,{valueLabelDisplay:"off","aria-label":"pretto slider",value:Number(n.rate),marks:t.marks1,max:300})}),t.marks1.length>0?Object(oe.jsxs)(R,{value:r.rate,children:[Object(oe.jsx)(D,{disabled:!0,"aria-label":"pretto slider",defaultValue:120,value:r.rate,max:300,valueLabelDisplay:"on",marks:t.marks,sx:{".css-1qlnp9f-MuiSlider-root .MuiSlider-markLabel[data-index='1']":{pr:70},".css-1qlnp9f-MuiSlider-root .MuiSlider-markLabel[data-index='2']":{pl:70}}}),Object(oe.jsx)("div",{className:"custom_range_flag",children:Object(oe.jsx)("div",{className:"range_val",children:"".concat(o(n.rate))})})]}):Object(oe.jsxs)(R,{className:"feature_item",value:Number(r.coverage),children:[Object(oe.jsx)(V,{disabled:!0,"aria-label":"pretto slider",defaultValue:20,value:r.coverage,valueLabelDisplay:"on",marks:t.marks,max:300}),Object(oe.jsx)("div",{className:"custom_range_flag",children:Object(oe.jsx)("div",{className:"range_val",children:i})})]})]})})}const re=Object(g.a)(M.a)(G||(G=Object(j.a)(["\n  margin-bottom: 20px;\n  display: flex;\n  height: 175px;\n  width: 100%;\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),le=Object(g.a)("div")(J||(J=Object(j.a)(["\n  width: 30%;\n"]))),ce=Object(g.a)("div")(K||(K=Object(j.a)(["\n  width: 70%;\n"]))),se=Object(g.a)("div")($||($=Object(j.a)(["\n  color: rgba(0, 0, 0, 0.5);\n"]))),de=Object(g.a)("div")(Q||(Q=Object(j.a)(["\n  margin-top: 10px;\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.5);\n"]))),be=Object(g.a)("div")(ee||(ee=Object(j.a)(["\n  margin-bottom: 14px;\n  font-family: PingFangSC-Semibold, sans-serif;\n  font-weight: 550;\n  font-size: 35px;\n  margin-top: 24px;\n  line-height: 35px;\n  color: #000000;\n"]))),ue=Object(g.a)("div")(te||(te=Object(j.a)(["\n  display: flex;\n"]))),pe=Object(g.a)("div")(ne||(ne=Object(j.a)(["\n  width: 25%;\n"]))),je=Object(g.a)("div")(ae||(ae=Object(j.a)(["\n  width: 75%;\n"])));var xe=function(){const[e,t]=Object(x.useState)({marks1:[{value:0,label:""},{value:110,label:"Liquidation"},{value:160,label:"Min. Mint"},{value:300,label:""}],marks:[{value:0,label:""},{value:110,label:"110%"},{value:160,label:"120%"},{value:300,label:""}]}),[n,a]=Object(x.useState)({marks1:[],marks:[{value:0,label:""},{value:110,label:"10"},{value:160,label:"20"},{value:300,label:""}]}),{currentPosition:o,currentPositionTokenInfo:i}=Object(I.c)(),{newCollateralRatio:r,newPrepaidInterestCoverage:l,onUpdateNeutralizeValue:c}=Object(I.a)(),{shortAmount:s,neutralizeAmount:d}=Object(y.d)(),{activeInfo:b}=Object(y.a)(),{rateInfo:u}=Object(y.c)(),[p,j]=Object(x.useState)(!1),{activeTab:m}=Object(y.c)();Object(x.useEffect)((()=>{let{coverage:e,rate:n}=u;1===m?s&&(u.rate<120?e="N/A":u.rate>=120&&e<20&&(e=20)):2===m&&(e=T.a.formatTokenAmount(l,0),n=T.a.formatTokenAmount(r,2)),a((t=>({...t,defaultvalue:e,showValue:e}))),t((e=>({...e,defaultvalue:n,showValue:n}))),j(!0)}),[m,r,l,u,s]);const h=Object(x.useMemo)((()=>{var e;return i.tokenPrice?Object(T.b)(null===(e=i.tokenPrice[o.mintTokenInfo.symbol])||void 0===e?void 0:e.price,o.mintTokenInfo.settlementCurrency.decimals):0}),[o,i]);return Object(x.useEffect)((()=>{if((null===b||void 0===b?void 0:b.tokenType)===k.b.NEUTRALIZE&&null!==b&&void 0!==b&&b.amount){const e=Number(null===b||void 0===b?void 0:b.amount);c(e?Number("-".concat(e)):0)}else if(2===m&&d){const e=Number(d);c(e?Number("-".concat(e)):0)}}),[b,c,d,m]),Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)(re,{children:[Object(oe.jsxs)(le,{children:[Object(oe.jsx)(se,{children:"Outstanding Debt"}),Object(oe.jsx)(be,{children:T.a.formatFourDecimals(Number(Object(T.b)(o.balance,o.mintTokenInfo.decimals)))}),Object(oe.jsxs)(de,{children:["Mark Price: ",h," WBTC"]})]}),p&&Object(oe.jsxs)(ce,{children:[Object(oe.jsxs)(ue,{children:[Object(oe.jsx)(pe,{style:{marginTop:"45px"},children:"Collateral Ratio"}),Object(oe.jsx)(je,{children:Object(oe.jsx)(ie,{value:e},1)})]}),Object(oe.jsxs)(ue,{children:[Object(oe.jsx)(pe,{children:"Prepaid Interest Coverage"}),Object(oe.jsx)(je,{children:Object(oe.jsx)(ie,{value:n},2)})]})]})]})})},me=n(1070),he=n(1071),ge=n(1036),fe=n(1069),Oe=n(1068),ve=n(1067),ye=n(1063),ke=n(710),we=n(998),Ce=n(494),Te=n.n(Ce),Ie=n(991),Ae=n.n(Ie),Se=n(413);const ze=e=>{let{state:t,val:n,token:a}=e;const{clearActive:o,setActionInfo:i,setActiveAmount:r}=Object(y.a)();return Object(oe.jsxs)(m.a,{sx:{width:74,height:32,borderRadius:10,border:"1px solid rgba(70, 79, 96, 0.2)",color:"rgba(134, 143, 160, 1)",display:"flex",alignItems:"center",background:"rgba(247, 249, 252, 1)",justifyContent:"space-between",p:1,cursor:"pointer",transition:"all 0.3s"},onClick:()=>{"close"===t&&o(),"up"===t&&(i({token:a,tokenType:k.b.SUPPLY}),r(Number(n))),"down"===t&&(i({token:a,tokenType:k.b.WithDraw}),r(Number(n)))},children:["up"===t&&Object(oe.jsx)("span",{style:{fontWeight:100,fontSize:"18px"},children:"+"}),"close"===t&&Object(oe.jsx)(Ae.a,{sx:{width:12,height:12}}),"down"===t&&Object(oe.jsx)("span",{style:{fontWeight:100,fontSize:"18px"},children:"-"}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,mt:.1,width:"40px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"right"},children:n})]})},Me=e=>{var t,n;let{pendingTokenTypes:a,symbol:o,tokenAmount:i}=e;const{activeInfo:r,setActionInfo:l}=Object(y.a)(),{walletTokenBalance:c}=Object(Se.a)(),s=Object(x.useMemo)((()=>c&&0===c[o]),[c,o]);return r.token!==o||r.tokenType!==k.b.SUPPLY&&r.tokenType!==k.b.WithDraw?null!==(t=a.get(o))&&void 0!==t&&t.includes(k.b.SUPPLY)?Object(oe.jsx)(ze,{token:o,state:"up",val:i[o]}):null!==(n=a.get(o))&&void 0!==n&&n.includes(k.b.WithDraw)?Object(oe.jsx)(ze,{token:o,state:"down",val:i[o]}):Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsx)(we.a,{disabled:s,onClick:()=>{s||l({token:o,tokenType:k.b.SUPPLY})},sx:Y.addAdnRemoveBtn,children:Object(oe.jsx)(Te.a,{sx:{fontSize:16}})})}):Object(oe.jsx)(ze,{token:o,state:"close",val:r.tokenType})};var Ne=()=>{const{walletTokenBalance:e}=Object(Se.a)(),{pendingActionList:t,tokenAmount:n}=Object(y.d)(),a=Object(x.useMemo)((()=>{const e=new Map;return t.forEach((t=>{const n=e.get(t.token)||[];n.push(t.tokenType),e.set(t.token,n)})),e}),[t]),{currentPositionTokenInfo:o,currentPosition:i}=Object(I.c)(),r=Object(x.useMemo)((()=>{if(o.allowedTokens){const{tokens:e,balances:t}=o.allowedTokens;return Object.keys(e).map((n=>{var a,o,i,r;return{symbol:null===(a=e[n])||void 0===a?void 0:a.symbol,address:null===(o=e[n])||void 0===o?void 0:o.address,icon:()=>{var t,a;return Object(oe.jsx)(z.a,{imgprops:{style:{marginRight:10}},token:null===(t=e[n])||void 0===t?void 0:t.logo,symbol:null===(a=e[n])||void 0===a?void 0:a.symbol})},decimals:null===(i=e[n])||void 0===i?void 0:i.decimals,balance:Object(T.b)(t[n]||0,null===(r=e[n])||void 0===r?void 0:r.decimals,!0)}}))}return[]}),[o]),l=Object(x.useCallback)((e=>{var t;const n=null===(t=o.tokenPrice[e.symbol])||void 0===t?void 0:t.price;return n?e.balance*Object(T.b)(n,i.mintTokenInfo.settlementCurrency.decimals,!0):0}),[i.mintTokenInfo.settlementCurrency.decimals,o.tokenPrice]);return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(me.a,{sx:{},"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:{fontSize:12,fontWeight:500,color:"rgba(0, 0, 0, 0.6)"},children:[Object(oe.jsx)(ge.a,{sx:{pl:0,pr:0},children:"Collateral Asset"}),Object(oe.jsx)(ge.a,{align:"right",sx:{pl:0,pr:0},children:"Collateral Balance"}),Object(oe.jsx)(ge.a,{align:"right",sx:{pl:0,pr:0},children:null})]})}),Object(oe.jsx)(he.a,{children:r.map((t=>Object(oe.jsxs)(ve.a,{sx:{"&:last-child td, &:last-child th":{border:0,transition:"all 0.3s"}},children:[Object(oe.jsxs)(ge.a,{sx:{display:"flex",alignItems:"center",pl:0,pr:0,height:66},children:[Object(oe.jsx)(t.icon,{}),Object(oe.jsxs)("div",{style:{marginLeft:"10px"},children:[Object(oe.jsx)(ke.a,{sx:{fontWeight:600},children:t.symbol}),Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(0, 0, 0, 0.5)"},children:[t.symbol," ",T.a.formatFourDecimals(e[t.symbol])," in wallet"]})]})]}),Object(oe.jsxs)(ge.a,{align:"right",sx:{p:0,height:66,transition:"all 0.3s"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:T.a.formatFourDecimals(t.balance)}),0!==e[t.symbol]&&Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(53, 5, 5, 0.5)"},children:[T.a.formatFourDecimals(l(t))," ",i.mintTokenInfo.settlementCurrency.symbol]})]}),Object(oe.jsx)(ge.a,{sx:{pl:0,pr:0,height:66},children:Object(oe.jsx)(m.a,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:Object(oe.jsx)(Me,{pendingTokenTypes:a,symbol:t.symbol,tokenAmount:n})})})]},t.symbol)))})]})})},Pe=n(1052),Fe=n(992),Ee=n.n(Fe),Re=n(706),De=n.n(Re),Ve=n(23),Le=n(108),Be=n(68),He=n(64),We=n(16),Ue=n(11),_e=n(216),Ze={"F(BTC,20)":C.j,"F(BTC,25)":C.j,WBTC:C.B,USDT:C.A,wallet:_e.a,avatar:C.b},Ye=n(92),Xe=n(10),qe=n(145),Ge=n(29),Je=n(109),Ke=n(93),$e=n(429),Qe=n(1046),et=n(1073),tt=n(993);var nt=e=>{let{handleClose:t,anchorEl:n,open:a,deadline:o,maxSlippageValue:i,setMaxSlippageValue:r,setDeadlineValue:l}=e;const[c,s]=Object(x.useState)(!1),[d,b]=Object(x.useState)(!1),[u,p]=Object(x.useState)(!1);return Object(oe.jsxs)(tt.a,{id:"basic-menu",anchorEl:n,open:a,onClose:t,MenuListProps:{"aria-labelledby":"basic-button"},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},PaperProps:{sx:{width:"288px",boxShadow:"none",mt:1.5,borderRadius:2,border:"1px solid rgba(207, 216, 226, 0.5)"}},children:[Object(oe.jsxs)(m.a,{sx:{pl:1.2,pr:1.2,mb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 0.5)"},children:"Max.slippage"}),Object(oe.jsx)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}})]}),Object(oe.jsxs)(m.a,{sx:{display:"flex",gap:1,pl:1.2,pr:1.2,height:50,width:268,alignItems:"center",ml:"9.6px",border:"1px solid #CFD8E2",borderRadius:2.6},children:[Object(oe.jsx)(m.a,{onClick:()=>{r("0.1"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:2.5,background:"0.1"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",height:"42px",width:"42px",fontSize:"12px"},children:"0.1%"}),Object(oe.jsx)(m.a,{onClick:()=>{r("0.5"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",background:"0.5"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",borderRadius:2.5,height:"42px",width:"42px",fontSize:"12px"},children:"0.5%"}),Object(oe.jsx)(m.a,{onClick:()=>{r("1"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:2.5,background:"1"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",height:"42px",width:"42px",fontSize:"12px"},children:"1%"}),Object(oe.jsx)(m.a,{sx:{flex:1.2,display:"flex",alignItems:"center",borderRadius:2,border:c||i>0&&"0.5"!==i&&"0.1"!==i&&"1"!==i?"1px solid rgba(110, 214, 243, 1)":"1px solid rgba(207, 216, 226, 0.5)",p:1},children:Object(oe.jsx)(Qe.a,{placeholder:"1",multiline:!0,maxRows:5,size:"small",onBlur:()=>s(!1),onFocus:()=>s(!0),value:i,onChange:e=>{let t="";const n=e.target.value.replace(/[^\d.]/g,"");if(n.includes(".")){var a;const e=n.split(".");e[1]=null===(a=e[1])||void 0===a?void 0:a.slice(0,2),t=e.join(".")}else t=n;b(!0),Number(e.target.value)<0||""===e.target.value?r("0"):Number(e.target.value)>49.9?r("49.9"):r(t.includes(".")?t.toString():parseFloat(t).toString())},sx:{"& .MuiInputBase-input":{textAlign:"right",color:d?"":"rgb(0 0 0 / 20%)"},"& .MuiInputBase-input::placeholder":{textAlign:"right"}},variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0,sx:{padding:0},endAdornment:Object(oe.jsx)(et.a,{position:"end",children:Object(oe.jsx)(ke.a,{sx:{textAlign:"left",fontSize:14,fontWeight:400,color:"rgba(0,0,0,1)"},children:"%"})})}})})]}),Object(oe.jsxs)(m.a,{sx:{pl:1.2,pr:1.2,display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:1},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 0.5)"},children:"Transaction deadline"}),Object(oe.jsx)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}})]}),Object(oe.jsx)(m.a,{sx:{height:50,flex:1,display:"flex",alignItems:"center",borderRadius:2,border:"1px solid rgba(207, 216, 226, 0.5)",p:1,ml:1.2,mr:1.2},children:Object(oe.jsx)(Qe.a,{placeholder:"10",multiline:!0,maxRows:5,size:"small",value:o,onChange:e=>{p(!0),l(e.target.value)},sx:{"& .MuiInputBase-input":{textAlign:"right",color:u?"":"rgb(0 0 0 / 20%)"},"& .MuiInputBase-input::placeholder":{textAlign:"right"}},variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0,sx:{padding:0},endAdornment:Object(oe.jsx)(et.a,{position:"end",children:Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 1)"},children:"minutes"})})}})})]})},at=n(705),ot=n.n(at),it=n(595);var rt,lt,ct=()=>{const{chainId:e}=Object(v.b)(),{tokenPools:t}=Object(Le.a)(),{supplyAllAmount:n,shortAmount:a}=Object(y.d)(),{activeInfo:o}=Object(y.a)(),{rateInfo:i}=Object(y.c)(),{collateralIndex:r,currentPosition:l}=Object(I.c)(),{onUpdateNeutralizeValue:c,onUpdateCollateralValue:s,newOutStandingDebt:d,newEstimatedDailyDebt:b,newDisplayCollateralRatio:u}=Object(I.a)(),p=Object(x.useMemo)((()=>{const{decimals:e,settlementCurrency:t}=l.mintTokenInfo;return{current:T.a.formatFourDecimals(Number(Object(T.b)(l.balance,e))),next:T.a.formatFourDecimals(Number(Object(T.b)(d,e))),newDisplayCollateralRatio:u,newEstimatedDailyDebt:T.a.formatTokenAmount(b/10**t.decimals,t.decimals)}}),[l.balance,l.mintTokenInfo,u,b,d]),j=Object(x.useMemo)((()=>{if(console.log("rateInfo.coverage",i.coverage,r.prepaidInterestCoverage,i.rate),i.rate>=120&&i.coverage<20){return T.a.formatTokenAmount(Number(p.newEstimatedDailyDebt)*it.b.days,l.mintTokenInfo.settlementCurrency.decimals)}return r.prepaidInterest}),[r.prepaidInterest,r.prepaidInterestCoverage,l.mintTokenInfo.settlementCurrency.decimals,p.newEstimatedDailyDebt,i.coverage,i.rate]),h=Object(x.useMemo)((()=>{let{coverage:e}=i;return a&&(e=i.rate<120?"N/A":i.rate>=120&&e<20?"".concat(20," days"):e===Number.POSITIVE_INFINITY?"+\u221e":"".concat(e," days")),[{id:1,title:Ke.b.CollateralRatio,type:"ratio",value:{upVal:r.displayRatio,downVal:i.rate?"".concat(i.rate,"%"):r.displayRatio}},{id:2,title:Ke.b.PrepaidInterestCoverage,type:"coverage",value:{upVal:r.displayCoverage,downVal:e}},{id:3,title:Ke.b.PrepaidInterest,type:"prepaidInterest",value:{upVal:"".concat(r.prepaidInterest," ").concat(l.mintTokenInfo.settlementCurrency.symbol),downVal:"".concat(j," WBTC")}},{id:4,title:"Daily Paid Interest Reference",type:"dailyPaid",value:{upVal:"".concat(Object(T.b)(l.positionStatus.estimatedDailyDebt,l.mintTokenInfo.settlementCurrency.decimals)," ").concat(l.mintTokenInfo.settlementCurrency.symbol),downVal:"\u2248 ".concat(p.newEstimatedDailyDebt," WBTC")}},{id:5,title:"Outstanding Debt",type:"debt",value:{upVal:p.current,downVal:"\u2248 ".concat(p.next)}}]}),[i,a,r.displayRatio,r.displayCoverage,r.prepaidInterest,l.mintTokenInfo.settlementCurrency.symbol,l.mintTokenInfo.settlementCurrency.decimals,l.positionStatus.estimatedDailyDebt,j,p]),g=Object(x.useCallback)((e=>{const t="ratio"===e.type&&r.collateralRatio<it.b.ratio||"coverage"===e.type&&r.prepaidInterestCoverage<it.b.days?"#FF4D00":"#2AA1FF";return["prepaidInterest","dailyPaid","debt"].includes(e.type)?"#2AA1FF":t}),[r.collateralRatio,r.prepaidInterestCoverage]);return Object(x.useEffect)((()=>{console.log("activeInfo",o);let e=0;o.token&&o.tokenType===k.b.SHORT?e=Number(o.amount):a&&(e=Number(a)),c(e)}),[a,c,o,s,l.mintTokenInfo.settlementCurrency.symbol,e,l.mintTokenInfo.symbol,l.mintTokenInfo.decimals,t,l.mintTokenInfo.settlementCurrency.decimals]),Object(oe.jsx)(m.a,{sx:{bgcolor:"rgba(222, 241, 255, 1)",borderRadius:1.8,mt:4,p:2,display:"flex",flexDirection:"column",gap:1.2},children:h.map((e=>Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.5)"},children:e.title}),Object(oe.jsxs)(m.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.6)",textAlign:"right"},children:e.value.upVal}),(a||n)&&Object(oe.jsxs)(m.a,{sx:{display:"flex",alignItems:"center",justifyContent:"end",textAlign:"right"},children:[Object(oe.jsx)(ot.a,{sx:{color:"rgba(0,0,0,0.1)",width:12,height:12}}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,color:g},children:e.value.downVal})]})||null]})]},e.id)))})};const st=Object(Xe.e)("div")(rt||(rt=Object(j.a)(["\n  font-family: PingFang SC;\n  font-size: 12px;\n  font-weight: 400;\n  line-height: 16.8px;\n  text-align: right;\n"]))),dt=Object(Xe.e)("div")(lt||(lt=Object(j.a)(["\n  position: absolute;\n  top: 33px;\n"]))),bt=(e,t)=>{if(Number.isNaN(e))return e;const n="".concat(e);return/e/i.test(n)?e.toFixed(t).replace(/\.?0+$/,""):e},ut=()=>{const[e,t]=Object(x.useState)(-1),{clearAllPendingAction:n,pendingActionList:a,deletePendingAction:o}=Object(y.d)(),{setActionInfo:i,setActiveAmount:r,setActionIndex:l}=Object(y.a)(),{currentMintToken:c}=Object(I.c)(),s=()=>{t(-1)};return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(me.a,{"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:_.tableHeader,children:[Object(oe.jsxs)(ge.a,{sx:_.tableHeadCell,children:[a.length," Pending Actions"]}),Object(oe.jsx)(ge.a,{align:"right",sx:_.tableHeadCell,children:Object(oe.jsx)(N.a,{size:"small",sx:_.clearAll,onClick:()=>{n()},children:"Clear All"})})]})}),Object(oe.jsx)(he.a,{sx:_.tableBody,children:a.map(((n,a)=>Object(oe.jsxs)(ve.a,{sx:_.tableBodyRow,onMouseEnter:()=>(e=>{t(e)})(a),onMouseLeave:s,onClick:()=>{i({token:n.token,tokenType:n.tokenType}),r(n.amount),l(a)},children:[Object(oe.jsxs)(ge.a,{sx:_.tableBodyCell,children:[Object(oe.jsx)(Pe.a,{color:"error",overlap:"circular",badgeContent:n.type===k.a.ADD?Object(oe.jsx)(Te.a,{sx:{width:7,height:7,color:"#000"}}):Object(oe.jsx)(Ee.a,{sx:{width:7,height:7,color:"#000"}}),anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{".MuiBadge-badge":{padding:0,minWidth:10,minHeight:10,height:10,position:"absolute",bottom:"20%",right:"24%",backgroundColor:"rgba(110, 214, 243, 1)",borderWidth:1,borderColor:"rgba(235, 247, 255, 1)",borderStyle:"solid"}},children:Ze[n.token]()}),Object(oe.jsxs)(ke.a,{sx:{fontWeight:600,marginLeft:"5px"},children:[n.tokenType," ",n.token]})]}),Object(oe.jsx)(ge.a,{align:"right",sx:{p:0,height:66},children:Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"end"},children:[Object(oe.jsxs)(m.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:n.amount}),Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(0, 0, 0, 0.5)"},children:[n.price,c]})]}),Object(oe.jsx)(m.a,{sx:{transition:"all 0.3s",width:e===a?32:0,display:"flex",alignItems:"center"},children:Object(oe.jsx)(we.a,{onClick:e=>{e.stopPropagation(),o(n.token,n.tokenType)},sx:{transition:"all 0.3s",opacity:e===a?1:0,color:"rgba(0, 0, 0, 1)"},children:Object(oe.jsx)(De.a,{sx:{width:16,height:16}})})})]})})]},n.tokenType+n.token)))})]})})};var pt=()=>{var e,t,n;const[a,o]=Object(x.useState)(null),[i,r]=Object(x.useState)(null!==(e=localStorage.getItem("slippage"))&&void 0!==e?e:"0.5"),[l,c]=Object(x.useState)(10),[s,d]=Object(x.useState)(!1),{chainId:b}=Object(v.b)(),{mintSellHelpContract:u,signer:p,tokenPools:j}=Object(Le.a)(),{walletTokenBalance:h}=Object(Se.a)(),{toastError:g,toastSuccess:f,toastInfo:O}=Object(Ye.a)(),{pendingActionList:w,shortAmount:A}=Object(y.d)(),{activeInfo:S,setActiveAmount:z,clearActive:M}=Object(y.a)(),{onApprove:P,approveStatus:E}=Object(y.b)(),{addPendingAction:R,updatePendingAction:D,clearAllPendingAction:V,pendingTokenTypes:L}=Object(y.d)(),{rateInfo:B,onChangeCollateralIndex:H}=Object(y.c)(),{currentPosition:W,collateralIndex:_,currentMintToken:Z}=Object(I.c)(),{newPrepaidInterestCoverage:Y,newCollateralRatio:X,onUpdateCollateralValue:q}=Object(I.a)(),{handleUpdatePosition:G}=Object(I.b)(),J=Object(x.useCallback)((()=>w.filter((e=>e.tokenType!==k.b.SHORT&&e.tokenType!==k.b.NEUTRALIZE)).map((e=>Ge.e[b].tokens[e.token].address))),[b,w]),K=Object(x.useCallback)((()=>w.filter((e=>e.tokenType!==k.b.SHORT&&e.tokenType!==k.b.NEUTRALIZE)).map((e=>Object(T.c)(e.amount.toString(),Ge.e[b].tokens[e.token].decimals)))),[b,w]);Object(x.useEffect)((()=>{let e=0;w.forEach((t=>{if(t.tokenType===k.b.SUPPLY)if(W.mintTokenInfo.settlementCurrency.symbol===t.token){const n=t.amount;e+=n}else{const n=Object(qe.b)(b,t.token,W.mintTokenInfo.settlementCurrency.symbol,Object(T.c)(String(t.amount),Ge.e[b].tokens[t.token].decimals),j);e+=Number(Object(T.b)(n,W.mintTokenInfo.settlementCurrency.decimals))}})),q({symbol:W.mintTokenInfo.settlementCurrency.symbol,value:e})}),[b,W.mintTokenInfo.settlementCurrency.decimals,W.mintTokenInfo.settlementCurrency.symbol,q,w,j]);const $=Object(x.useMemo)((()=>Boolean(a)),[a]),Q=Object(x.useMemo)((async()=>{if(u&&u.previewPositionInfoAfterShort){if(!A)return H({ratio:Number(T.a.formatTokenAmount(X,2)),coverage:Number(T.a.formatTokenAmount(Y,0))}),{targetCollateralRatio:_.collateralRatio};const e=await u.previewPositionInfoAfterShort(W.positionAddress,Object(T.c)(A.toString(),W.mintTokenInfo.decimals),J(),K());return H({ratio:e.targetCollateralRatio.toNumber()/100,coverage:Number(T.a.formatTokenAmount(Y,0))}),e}return{targetCollateralRatio:0}}),[u,A,W.positionAddress,W.mintTokenInfo.decimals,J,K,H,Y,X,_.collateralRatio]),ee=Object(x.useCallback)((async()=>{const e=await Q,t=new He.utils.Interface(Be.a.actionMintSell.abi),{decimals:n}=W.mintTokenInfo,a=t.encodeFunctionData("short",[Object(T.c)(A.toString(),n),Object(T.c)(T.a.formatTokenAmount(A-A*(i/100),n),n),J(),K(),e.targetCollateralRatio,Number((Date.now()/1e3).toFixed())+60*l]);try{const e=new We.a.Contract(W.positionAddress,Je,p),t=await e.delegateCall(Be.a.actionMintSell.address[b],a);try{if(void 0!==t&&t.hash){O(Ke.e.submited,Object(oe.jsx)($e.a,{content:"Waiting for confirmation",txHash:t.hash}));0!==(await t.wait()).confirmations&&(f(Ke.e.success,Object(oe.jsx)($e.a,{content:"Transaction was successful",txHash:t.hash})),M(),V(),await G())}}catch(o){g(Ke.e.failed,o.reason)}}catch(o){g(Ke.e.failed,o.reason)}}),[K,J,b,M,V,Q,W.mintTokenInfo,W.positionAddress,l,G,i,A,p,g,O,f]),te=Object(x.useMemo)((()=>{const e=h&&h[S.token],t=S.amount&&S.amount>e,n=Number(S.amount)<=0;return S.tokenType!==k.b.SHORT&&t||n}),[S.amount,S.token,S.tokenType,h]),ne=Object(x.useMemo)((()=>{let{coverage:e}=B;return A&&(B.rate<120?e="N/A":B.rate>=120&&e<20&&(e=20)),!(B.rate>=120&&e>=20)}),[B,A]),ae=Object(x.useMemo)((()=>-1!==S.activeIndex),[S.activeIndex]),[ie,re]=Object(x.useState)(!1),le=Object(x.useCallback)((async()=>{if(te)return;const e={token:S.token,tokenType:S.tokenType,amount:Number(S.amount),price:S.amount};if(Z!==S.token){const t=Ge.e[b].tokens[S.token].decimals,n=Ue.a.from(T.a.formatTokenAmount(S.amount*10**t,0)),a=Object(qe.b)(b,S.token,Z,n,j);e.price=T.a.formatFourDecimals(Number(Object(T.b)(a,W.mintTokenInfo.decimals)))}if(E)ae?(D(e),M()):(R(e),M());else{d(!0);try{const t=await P();O("Approve Submitted");1===(await t.wait()).status&&(D(e),M(),d(!1),f("Approved Successfully"))}catch(t){d(!1)}}}),[S.amount,S.token,S.tokenType,R,E,b,M,Z,W.mintTokenInfo.decimals,te,ae,P,O,f,j,D]);return Object(oe.jsxs)(m.a,{sx:{width:"100%"},children:[Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:16,fontWeight:500},children:null!==S&&void 0!==S&&S.token?"".concat(S.tokenType," ").concat(S.token):"".concat(Z," Wallet Balance")}),Object(oe.jsx)(we.a,{"aria-controls":$?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":$?"true":void 0,onClick:e=>{o(e.currentTarget)},sx:{p:0,width:24,height:24},children:Object(oe.jsx)(C.t,{})}),Object(oe.jsx)(nt,{handleClose:()=>{o(null)},anchorEl:a,maxSlippageValue:i,open:$,deadline:l,setMaxSlippageValue:e=>{localStorage.setItem("slippage",e),r(e)},setDeadlineValue:e=>c(e)})]}),Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.6},children:[Object(oe.jsxs)(m.a,{sx:{display:"flex",alignItems:"center",gap:1.2,width:"100%",height:"45px",transition:"300ms all"},children:[null!==S&&void 0!==S&&S.token?Ze[null===S||void 0===S?void 0:S.token]({style:{width:42,height:42}}):Object(oe.jsx)(C.j,{style:{width:42,height:42}}),Object(oe.jsxs)("div",{style:{width:"100%",position:"relative"},children:[Object(oe.jsx)(U,{children:Object(oe.jsx)("input",{readOnly:!(null!==S&&void 0!==S&&S.token),type:"number",placeholder:null!==S&&void 0!==S&&S.token?0:h[Z],value:null!==S&&void 0!==S&&S.amount.toString()?bt(null===S||void 0===S?void 0:S.amount,Ve.b[S.token].decimals):"",onFocus:()=>re(!0),onBlur:()=>{(""===(null===S||void 0===S?void 0:S.amount.toString())||(null===S||void 0===S?void 0:S.amount)<0)&&re(!1)},onChange:e=>{let t="";const n=e.target.value.replace(/[^\d.]/g,"");if(n.includes(".")){var a;const e=n.split(".");e[1]=null===(a=e[1])||void 0===a?void 0:a.slice(0,8),t=e.join(".")}else t=n;z(t||"")}})}),null!==S&&void 0!==S&&S.token&&ie&&"Short"!==S.tokenType?Object(oe.jsx)(dt,{children:Object(oe.jsx)(m.a,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",color:"rgba(0,0,0,.5)",paddingLeft:"4px"},children:Object(oe.jsxs)(st,{children:[h[null!==(t=null===S||void 0===S?void 0:S.token)&&void 0!==t?t:Z]," Available"]})})}):Object(oe.jsx)(oe.Fragment,{})]})]}),(null===S||void 0===S?void 0:S.token)&&S.tokenType!==k.b.SHORT&&Object(oe.jsx)(m.a,{children:Object(oe.jsx)(N.a,{size:"small",sx:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"},onClick:()=>(()=>{var e;"Short"!==S.tokenType&&z(h[null!==(e=null===S||void 0===S?void 0:S.token)&&void 0!==e?e:Z])})(),children:"Max"})})]}),(null===S||void 0===S?void 0:S.token)&&Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:3,mt:3},children:[Object(oe.jsx)(F,{variant:"contained",disableElevation:!0,onClick:()=>{M()},children:"Cancel"}),Object(oe.jsx)(F,{disabled:te||s,variant:"contained",disableElevation:!0,onClick:le,children:E?"".concat(ae?"Update":"Add"," Action"):"Approve & Add"})]}),w.length>0&&Object(oe.jsx)(m.a,{children:Object(oe.jsx)(ut,{})}),(null===(n=L.get(Z))||void 0===n?void 0:n.includes(k.b.SHORT))&&Object(oe.jsx)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:Object(oe.jsx)(F,{onClick:()=>ee(),variant:"contained",disableElevation:!0,disabled:ne,children:"Submit Transaction"})}),Object(oe.jsx)(ct,{})]})};var jt=function(){return Object(oe.jsxs)("div",{style:B,children:[Object(oe.jsx)(H,{children:Object(oe.jsx)(Ne,{})}),Object(oe.jsx)(W,{children:Object(oe.jsx)(pt,{})})]})},xt=n.p+"static/media/neutralize.1c2056a6.svg";var mt,ht,gt=e=>{let{neutralizeType:t}=e;const{walletTokenBalance:n}=Object(Se.a)(),{neutralizeAmount:a}=Object(y.d)(),{activeInfo:o}=Object(y.a)(),{activeTab:i}=Object(y.c)(),{collateralIndex:r,currentPosition:l,currentPositionTokenInfo:c}=Object(I.c)(),{newEstimatedDailyDebt:s,newOutStandingDebt:d,newNeutralizeFee:b,newPrepaidInterestCoverage:u,newDisplayPrepaidInterestCoverage:p,newDisplayCollateralRatio:j,newCollateralRatio:h,onUpdateNeutralizeValue:g}=Object(I.a)(),f=Object(x.useMemo)((()=>{if(c.allowedTokens){const{balances:e,tokens:t}=c.allowedTokens;return Object.keys(e).reduce(((n,a)=>({...n,[a]:Object(T.b)(e[a],t[a].decimals,!0)})),{})}return Object.keys(Ge.h).reduce(((e,t)=>({...e,[t]:0})),{})}),[c.allowedTokens]),O=Object(x.useMemo)((()=>[{id:1,title:"Collateral Ratio",type:"ratio",value:{upVal:r.displayRatio,downVal:j}},{id:2,title:"Prepaid Interest Coverage",type:"coverage",value:{upVal:r.displayCoverage,downVal:u>0||u!==Number.POSITIVE_INFINITY?"\u2248 ".concat(p):p}},{id:3,title:"Prepaid Interest",type:"prepaidInterest",value:{upVal:"".concat(r.prepaidInterest," ").concat(l.mintTokenInfo.settlementCurrency.symbol),downVal:"".concat(r.prepaidInterest," ").concat(l.mintTokenInfo.settlementCurrency.symbol)}},{id:4,title:"Daily Paid Interest Reference",type:"dailyPaid",value:{upVal:"".concat(r.estimatedDailyDebt," WBTC"),downVal:"".concat(Object(T.b)(Number(T.a.formatTokenAmount(s,0)),l.mintTokenInfo.settlementCurrency.decimals)," ").concat(l.mintTokenInfo.settlementCurrency.symbol)}},{id:5,title:"Outstanding Debt",type:"debt",value:{upVal:Object(T.b)(l.balance,l.mintTokenInfo.decimals),downVal:Object(T.b)(d,l.mintTokenInfo.decimals)}},{id:6,title:"Estimate Neutralize Fee",type:"neutralizeFee",value:{upVal:"0 ".concat(l.mintTokenInfo.settlementCurrency.symbol),downVal:"\u2248 ".concat(b," ").concat(l.mintTokenInfo.settlementCurrency.symbol)}}]),[r.displayRatio,r.displayCoverage,r.prepaidInterest,r.estimatedDailyDebt,j,u,p,l.mintTokenInfo.settlementCurrency.symbol,l.mintTokenInfo.settlementCurrency.decimals,l.mintTokenInfo.decimals,l.balance,s,d,b]),v=Object(x.useCallback)((e=>{const a="wallet"===t&&n&&b>n[l.mintTokenInfo.settlementCurrency.symbol],o="avatar"===t&&f&&b>f[l.mintTokenInfo.settlementCurrency.symbol],i="ratio"===e.type&&h<120&&a||"ratio"===e.type&&h<120&&o||"coverage"===e.type&&u<20&&o||"coverage"===e.type&&u<20&&a?"#FF4D00":"#2AA1FF";return["prepaidInterest","dailyPaid","debt"].includes(e.type)?"#2AA1FF":i}),[f,l.mintTokenInfo.settlementCurrency.symbol,t,h,b,u,n]);return Object(x.useEffect)((()=>{if((null===o||void 0===o?void 0:o.tokenType)===k.b.NEUTRALIZE&&null!==o&&void 0!==o&&o.amount){const e=Number(null===o||void 0===o?void 0:o.amount);g(e?Number("-".concat(e)):0)}else if(2===i&&a){const e=Number(a);g(e?Number("-".concat(e)):0)}}),[o,g,a,i]),Object(oe.jsx)(m.a,{sx:{bgcolor:"rgba(222, 241, 255, 1)",borderRadius:1.8,mt:4,p:2,display:"flex",flexDirection:"column",gap:1.2},children:O.map((e=>Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",textAlign:"right"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.5)",textAlign:"right"},children:e.title}),Object(oe.jsxs)(m.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.6)",textAlign:"right"},children:e.value.upVal}),Object(oe.jsxs)(m.a,{sx:{display:"flex",alignItems:"center",textAlign:"right",justifyContent:"end"},children:[Object(oe.jsx)(ot.a,{sx:{color:"rgba(0,0,0,0.1)",width:12,height:12}}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,color:v(e),textAlign:"right"},children:e.value.downVal})]})||null]})]},e.id)))})};function ft(){return Object(oe.jsx)("div",{children:Object(oe.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(oe.jsx)("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:"#FF2E00"}),Object(oe.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.57852 10.156C8.82398 10.156 9.02296 10.355 9.02296 10.6004V11.756C9.02296 12.0015 8.82398 12.2004 8.57852 12.2004H7.42296C7.1775 12.2004 6.97852 12.0015 6.97852 11.756V10.6004C6.97852 10.355 7.1775 10.156 7.42296 10.156H8.57852ZM8.57852 3.62842C8.82398 3.62842 9.02296 3.8274 9.02296 4.07286V8.74859C9.02296 8.99405 8.82398 9.19303 8.57852 9.19303H7.42296C7.1775 9.19303 6.97852 8.99405 6.97852 8.74859V4.07286C6.97852 3.8274 7.1775 3.62842 7.42296 3.62842H8.57852Z",fill:"white"})]})})}function Ot(){return Object(oe.jsx)("div",{children:Object(oe.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(oe.jsx)("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:"#73797C"}),Object(oe.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.42295 5.6736C7.17749 5.6736 6.9785 5.47461 6.9785 5.22915V4.0736C6.9785 3.82814 7.17749 3.62915 7.42295 3.62915H8.5785C8.82396 3.62915 9.02295 3.82814 9.02295 4.0736L9.02295 5.22915C9.02295 5.47461 8.82396 5.6736 8.5785 5.6736H7.42295ZM7.42295 12.2012C7.17749 12.2012 6.9785 12.0022 6.9785 11.7567V7.081C6.9785 6.83554 7.17749 6.63656 7.42295 6.63656H8.5785C8.82396 6.63656 9.02295 6.83554 9.02295 7.081V11.7567C9.02295 12.0022 8.82396 12.2012 8.5785 12.2012H7.42295Z",fill:"white"})]})})}const vt=Object(Xe.e)("div")(mt||(mt=Object(j.a)(["\n  font-family: PingFang SC;\n  font-size: 12px;\n  font-weight: 400;\n  line-height: 16.8px;\n  text-align: right;\n"]))),yt=Object(Xe.e)("div")(ht||(ht=Object(j.a)(["\n  position: absolute;\n  top: 33px;\n"]))),kt=e=>{let{setNeutralizeType:t}=e;const[n,a]=Object(x.useState)(-1),{setActionInfo:o,setActiveAmount:i,setActionIndex:r}=Object(y.a)(),{pendingActionList:l,clearAllPendingAction:c,deleteNeutralizePendingAction:s}=Object(y.d)(),d=()=>{a(-1)};return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(me.a,{"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:_.tableHeader,children:[Object(oe.jsxs)(ge.a,{sx:_.tableHeadCell,children:[l.length," Pending Actions"]}),Object(oe.jsx)(ge.a,{align:"right",sx:_.tableHeadCell,children:Object(oe.jsx)(N.a,{size:"small",sx:_.clearAll,onClick:()=>{c()},children:"Clear All"})})]})}),Object(oe.jsx)(he.a,{sx:_.tableBody,children:l.map(((e,l)=>Object(oe.jsxs)(ve.a,{sx:_.tableBodyRow,onMouseEnter:()=>(e=>{a(e)})(l),onMouseLeave:d,onClick:()=>{o({token:e.token,tokenType:e.tokenType}),i(e.amount),r(l),t(e.neutralizeType)},children:[Object(oe.jsxs)(ge.a,{sx:_.tableBodyCell,children:[Object(oe.jsx)(Pe.a,{color:"error",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{".MuiBadge-badge":{padding:0,minWidth:10,minHeight:10,height:10,position:"absolute",bottom:"20%",right:"24%",backgroundColor:"rgba(110, 214, 243, 1)",borderWidth:1,borderColor:"rgba(235, 247, 255, 1)",borderStyle:"solid"}},children:Ze[e.neutralizeType]()}),Object(oe.jsxs)(ke.a,{sx:{fontWeight:600,marginLeft:"5px"},children:[e.tokenType," ",e.token]})]}),Object(oe.jsx)(ge.a,{align:"right",sx:{p:0,height:66},children:Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"end",alignItems:"center"},children:[Object(oe.jsx)(m.a,{children:Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:e.amount})}),Object(oe.jsx)(m.a,{sx:{transition:"all 0.3s",width:n===l?32:0,display:"flex",alignItems:"center"},children:Object(oe.jsx)(we.a,{onClick:t=>{t.stopPropagation(),s(e.token,e.neutralizeType)},sx:{transition:"all 0.3s",opacity:n===l?1:0,color:"rgba(0, 0, 0, 1)"},children:Object(oe.jsx)(De.a,{sx:{width:16,height:16}})})})]})})]},e.tokenType+e.token)))})]})})},{ActionUser:wt}=Be.a,Ct=new He.utils.Interface(wt.abi);var Tt,It,At,St,zt=function(){var e;const{chainId:t}=Object(v.b)(),{walletTokenBalance:n,setRefresh:a}=Object(Se.a)(),[o,i]=Object(x.useState)("wallet"),[r,l]=Object(x.useState)(""),{addPendingAction:c,updateNeutralizePendingAction:s,deleteNeutralizePendingAction:d,clearAllPendingAction:b,pendingActionList:u}=Object(y.d)(),{signer:p}=Object(Le.a)(),{toastSuccess:j,toastError:h,toastInfo:g}=Object(Ye.a)(),[f,O]=Object(x.useState)(!1),[w,A]=Object(x.useState)(!1),{activeInfo:S,setActiveAmount:z,setActiveTab:M,clearActive:P}=Object(y.a)(),{onApprove:E,approveStatus:R}=Object(y.b)(),D=Object(x.useMemo)((()=>-1!==S.activeIndex),[S.activeIndex]),[V,L]=Object(x.useState)(!1),[,B]=Object(x.useState)(!0),{currentPositionTokenInfo:H,currentMintToken:W,currentPosition:_}=Object(I.c)(),{handleUpdatePosition:Z}=Object(I.b)(),{newNeutralizeFee:Y}=Object(I.a)(),G=Object(x.useMemo)((()=>{if(H.allowedTokens){const{balances:e,tokens:t}=H.allowedTokens;return Object.keys(e).reduce(((n,a)=>({...n,[a]:Object(T.b)(e[a],t[a].decimals,!0)})),{})}return Object.keys(Ge.h).reduce(((e,t)=>({...e,[t]:0})),{})}),[H.allowedTokens]),J=Object(x.useMemo)((()=>Number(Object(T.b)(_.balance,_.mintTokenInfo.decimals))),[_.balance,_.mintTokenInfo.decimals]),K=Object(x.useMemo)((()=>r<=0||r>0&&("wallet"===o?r>n[S.token]||r>J:r>G[S.token]||r>J)),[S.token,G,J,r,o,n]),$=Object(x.useMemo)((()=>0===u.length),[u]),Q=Object(x.useMemo)((()=>u.some((e=>!(!e||!e.neutralizeType)&&e.neutralizeType===o))),[o,u]),ee=Object(x.useCallback)((async()=>{u.forEach((async e=>{if(e.tokenType===k.b.NEUTRALIZE){L(!0);const o=Ct.encodeFunctionData("neutralizetBalance",[Object(T.c)(e.amount.toString(),_.mintTokenInfo.decimals)||"0","wallet"===e.neutralizeType]);try{const e=new We.a.Contract(_.positionAddress,Je,p),n=await e.delegateCall(wt.address[t],o);if(n){l(0),g(Ke.e.submited,Object(oe.jsx)($e.a,{content:"Waiting for confirmation",txHash:n.hash}));await n.wait()&&(a((e=>!e)),j(Ke.e.success,Object(oe.jsx)($e.a,{content:"Transaction was successful",txHash:n.hash})),b(),l(""),z(""),L(!1),await Z())}}catch(n){L(!1),h(Ke.e.failed,null===n||void 0===n?void 0:n.reason)}}}))}),[u,_.mintTokenInfo.decimals,_.positionAddress,p,t,g,a,j,b,z,Z,h]),te=Object(x.useCallback)((()=>"wallet"===o?n&&Y>n[_.mintTokenInfo.settlementCurrency.symbol]:"avatar"===o&&(G&&Y>G[_.mintTokenInfo.settlementCurrency.symbol])),[G,_.mintTokenInfo.settlementCurrency.symbol,o,Y,n]),ne=Object(x.useCallback)((e=>"wallet"===o&&"wallet"===e?n&&r>n[W]?"red":"":"avatar"===o&&"avatar"===e&&G&&r>G[W]?"red":""),[G,r,o,W,n]),ae=Object(x.useCallback)((e=>{const{settlementCurrency:t}=_.mintTokenInfo;return o===e?n&&Y>n[t.symbol]?"red":"":o===e&&G&&Y>G[t.symbol]?"red":""}),[G,_.mintTokenInfo,o,Y,n]);return Object(oe.jsxs)(m.a,{sx:{width:"100%"},children:[Object(oe.jsx)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:Object(oe.jsxs)(ke.a,{sx:{fontSize:16,fontWeight:500},children:["Neutralize ",W]})}),Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.6},children:[Object(oe.jsx)(m.a,{sx:{height:"45px",transition:"300ms all",width:"100%"},children:Object(oe.jsxs)(m.a,{sx:{display:"flex",alignItems:"center",gap:1.2,width:"100%"},children:[Object(oe.jsx)(C.j,{style:{width:42,height:42}}),Object(oe.jsxs)("div",{style:{width:"100%",position:"relative"},children:[Object(oe.jsx)(U,{children:Object(oe.jsx)("input",{type:"number",placeholder:"0",value:null!==(e=null===S||void 0===S?void 0:S.amount)&&void 0!==e?e:"",onBlur:()=>{(""===(null===S||void 0===S?void 0:S.amount.toString())||(null===S||void 0===S?void 0:S.amount)<0)&&O(!1)},onFocus:()=>O(!0),onChange:e=>{let n="";const a=e.target.value.replace(/[^\d.]/g,"");if(a.includes(".")){var o;const e=a.split(".");e[1]=null===(o=e[1])||void 0===o?void 0:o.slice(0,Ge.e[t].tokens[W].decimals),n=e.join(".")}else n=a;z(n||""),l(n||"")}})}),null!==S&&void 0!==S&&S.token&&f?Object(oe.jsx)(yt,{children:Object(oe.jsx)(m.a,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",color:"rgba(0,0,0,.5)",paddingLeft:"4px",position:"relative"},children:Object(oe.jsxs)(vt,{children:["wallet"===o?n[null===S||void 0===S?void 0:S.token]:G[null===S||void 0===S?void 0:S.token]," ","Available"]})})}):Object(oe.jsx)(oe.Fragment,{})]})]})}),Object(oe.jsx)(m.a,{children:Object(oe.jsx)(N.a,{size:"small",sx:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"},onClick:()=>(l(J),z(J),"avatar"===o&&(G&&G[W]&&G[W]>J?B(!1):B(!0)),void("wallet"===o&&(n&&n[W]&&n[W]>J?B(!1):B(!0)))),children:"Max"})})]}),Object(oe.jsxs)(q,{children:[Object(oe.jsx)("p",{className:"title-neutralize",children:"Neutralize the asset from"}),Object(oe.jsxs)("div",{className:"content",children:[Object(oe.jsx)("div",{className:"item_wrap ".concat("wallet"===o?"active":""),onClick:()=>{i("wallet");const e=u.find((e=>"avatar"===e.neutralizeType));console.log("neutralize",e),e?d(e.token,e.neutralizeType):(r>0&&D||Q)&&c({currentMintToken:W,tokenType:k.b.NEUTRALIZE,amount:Number(r),neutralizeType:"wallet",price:1})},onKeyUp:()=>null,tabIndex:0,role:"button",children:Object(oe.jsxs)("div",{className:"item wallet",children:[Object(oe.jsxs)("h4",{children:[Object(oe.jsx)(_e.a,{})," My Wallet"]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:W}),Object(oe.jsx)("span",{style:{color:ne("wallet")},children:n&&T.a.formatFourDecimals(n[W])||0})]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:_.mintTokenInfo.settlementCurrency.symbol}),Object(oe.jsx)("span",{style:{color:ae("wallet")},children:n&&T.a.formatFourDecimals(n[_.mintTokenInfo.settlementCurrency.symbol])||0})]})]})}),Object(oe.jsx)("div",{className:"item_wrap ".concat("avatar"===o?"active":""),onClick:()=>{i("avatar");const e=u.find((e=>"wallet"===e.neutralizeType));console.log("neutralize",e),e?d(e.token,e.neutralizeType):(r>0&&D||Q)&&c({token:W,tokenType:k.b.NEUTRALIZE,amount:Number(r),neutralizeType:"avatar",price:1})},onKeyUp:()=>null,tabIndex:0,role:"button",children:Object(oe.jsxs)("div",{className:"item avatar",children:[Object(oe.jsxs)("h4",{children:[Object(oe.jsx)(C.b,{}),"Collateral"]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:W}),Object(oe.jsx)("span",{style:{color:ne("avatar")},children:G&&T.a.formatFourDecimals(G[W])||0})]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:_.mintTokenInfo.settlementCurrency.symbol}),Object(oe.jsx)("span",{style:{color:ae("wallet")},children:G&&T.a.formatFourDecimals(G[_.mintTokenInfo.settlementCurrency.symbol])||0})]})]})})]})]}),Object(oe.jsxs)(X,{children:[te()?Object(oe.jsx)(ft,{}):Object(oe.jsx)(Ot,{}),Object(oe.jsx)("p",{style:{color:te()?"red":""},children:"A 1.0% fee of the token value will be levied after the position is neutralized."})]}),Object(oe.jsxs)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:3,mt:1.6},children:[Object(oe.jsx)(F,{variant:"contained",disableElevation:!0,disabled:V,onClick:()=>{b(),P(),l(""),M(1)},children:"Cancel"}),Object(oe.jsx)(F,{variant:"contained",disableElevation:!0,disabled:K||w||V,onClick:async()=>{const e={token:W,tokenType:k.b.NEUTRALIZE,amount:Number(r),neutralizeType:o,price:1};if(R)D||Q?s(e):r>0&&c(e);else{A(!0);try{const t=await E();g("Approve Submitted");1===(await t.wait()).status&&(c(e),P(),A(!1),j("Approved Successfully"))}catch(t){A(!1)}}},children:R?"".concat(D||Q?"Update":"Add"," Action"):"Approve & Add"})]}),u.length>0&&Object(oe.jsx)(m.a,{children:Object(oe.jsx)(kt,{setNeutralizeType:e=>{i(e)}})}),u.length>0&&Object(oe.jsx)(m.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:Object(oe.jsx)(F,{onClick:()=>{ee()},disabled:$||V,variant:"contained",disableElevation:!0,children:"Submit Transaction"})}),Object(oe.jsx)(gt,{neutralizeType:o})]})};const Mt=Object(Xe.e)("div")(Tt||(Tt=Object(j.a)(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 539px;\n  margin: auto;\n\n  img {\n    width: 539px;\n    height: 368.98px;\n  }\n\n  .nutralize_action {\n    position: absolute;\n    display: flex;\n    width: 100px;\n    top: 0;\n    right: 43px;\n  }\n\n  .collateral_action {\n    bottom: 0;\n    left: 0;\n    position: absolute;\n    display: flex;\n\n    p {\n      flex-direction: column;\n    }\n  }\n"]))),Nt=Object(Xe.e)("span")(It||(It=Object(j.a)(["\n  font-family: PingFangSC-Medium, sans-serif;\n  display: block;\n  width: 25px;\n  height: 25px;\n  border-radius: 50%;\n  text-align: center;\n  line-height: 25px;\n  font-weight: 500;\n  font-size: 20px;\n  border: 1px solid #000000;\n  color: #000000;\n  margin-right: 13px;\n  flex: none;\n"]))),Pt=Object(Xe.e)("p")(At||(At=Object(j.a)(["\n  span {\n    font-family: PingFangSC-Medium, sans-serif;\n    font-weight: 500;\n    font-size: 16px;\n    line-height: 22px;\n    color: #000000;\n    white-space: nowrap;\n  }\n\n  display: flex;\n  flex-wrap: wrap;\n"]))),Ft=Object(Xe.e)(C.c)(St||(St=Object(j.a)(["\n  box-shadow: none !important;\n  background: linear-gradient(90deg, #61c2f7 0%, #7ae9f0 100%) !important;\n  color: #000 !important;\n  border-radius: 20px !important;\n  height: 24px !important;\n  line-height: 24px !important;\n  font-family: PingFangSC-Medium, sans-serif !important;\n  font-weight: 500 !important;\n  font-size: 12px !important;\n  letter-spacing: 0.02em !important;\n  margin-top: 13px !important;\n  white-space: nowrap !important;\n"])));var Et,Rt,Dt=function(){return Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)("div",{style:B,children:[Object(oe.jsx)(H,{children:Object(oe.jsxs)(Mt,{children:[Object(oe.jsx)("img",{src:xt,alt:""}),Object(oe.jsxs)("div",{className:"action nutralize_action",children:[Object(oe.jsx)(Nt,{children:"1"})," ",Object(oe.jsx)(Pt,{children:Object(oe.jsx)("span",{children:"Neutralize"})})]}),Object(oe.jsxs)("div",{className:"action collateral_action",children:[Object(oe.jsx)(Nt,{children:"2"})," ",Object(oe.jsxs)(Pt,{children:[Object(oe.jsxs)("span",{children:["Get back the ",Object(oe.jsx)("br",{})," collateral to wallet"]}),Object(oe.jsx)(h.b,{to:"/collateral/manage",children:Object(oe.jsx)(Ft,{children:"Collateral Management"})})]})]})]})}),Object(oe.jsx)(W,{children:Object(oe.jsx)(zt,{})})]})})};const Vt=Object(g.a)("div")(Et||(Et=Object(j.a)(["\n  padding-right: 40px;\n  height: 80vh;\n  overflow: scroll;\n  min-width: 1200px;\n  padding-bottom: 30px;\n"]))),Lt=Object(g.a)("div")(Rt||(Rt=Object(j.a)(["\n  font-size: 14px;\n"])));function Bt(){const{chainId:e}=Object(v.b)(),{clearAllPendingAction:t}=Object(y.d)(),{pendingActionList:n}=Object(y.d)(),{setActionInfo:a,setActiveAmount:o,setActiveTab:i}=Object(y.a)(),r=Object(w.c)((e=>e.short.activeTab)),l=Object(x.useMemo)((()=>{const e=n.filter((e=>e.tokenType===k.b.SHORT));return e.length&&e[0].amount||""}),[n]),[c,s]=Object(x.useState)(r),{onChangeCollateralIndex:d}=Object(y.c)(),{currentMintToken:b,currentPosition:u,collateralIndex:p}=Object(I.c)(),{handleChangeCurrentPosition:j}=Object(I.b)(),g=Object(x.useMemo)((()=>{if(Object(A.f)(e)){const t=S.c[e].tokens;return Object.keys(S.c[e].tokens).map((e=>({token:t[e].symbol,address:t[e].address,decimals:t[e].decimals,icon:()=>Object(oe.jsx)(z.a,{imgprops:{style:{marginRight:10}},token:t[e].logo,symbol:t[e].symbol})})))}return[]}),[e]);return Object(x.useEffect)((()=>{s(r)}),[r]),Object(x.useEffect)((()=>{d({ratio:Number(T.a.formatTokenAmount(p.collateralRatio,2)),coverage:Number(T.a.formatTokenAmount(p.prepaidInterestCoverage,0))})}),[p,d]),Object(oe.jsxs)(m.a,{sx:Z.box,children:[Object(oe.jsx)(f.f,{children:"Short & Neutralize"}),Object(oe.jsxs)(Vt,{children:[Object(oe.jsxs)(m.a,{sx:Z.topBox,children:[Object(oe.jsx)(O.a,{selectValue:b,options:g,isGroup:!1,onChange:e=>{j(e),t()}}),u.isEnable&&Object(oe.jsxs)(m.a,{sx:{display:"flex",gap:"12px"},children:[1===c&&Object(oe.jsxs)(F,{variant:"contained",disableElevation:!0,onClick:()=>{a({token:b,tokenType:k.b.SHORT}),o(Number(l)||""),1!==r&&t(),s(1),i(1)},children:["Short ",l&&T.a.formatFourDecimals(Number(l))]}),Number(l)<=0&&Object(oe.jsx)(F,{variant:"contained",disableElevation:!0,onClick:()=>{t(),i(2),s(2),a({token:b,tokenType:k.b.NEUTRALIZE})},children:"Neutralize"})]})]}),!u.isEnable&&Object(oe.jsxs)(h.b,{to:"/collateral",children:[" ",Object(oe.jsxs)(Lt,{children:["Please enable the collateral of ",u.mintTokenInfo.symbol," first ",Object(oe.jsx)(C.a,{})]})]}),u.isEnable&&Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)(xe,{}),1===c&&Object(oe.jsx)(jt,{}),2===c&&Object(oe.jsx)(Dt,{})]})]})]})}t.default=Object(x.memo)(Bt)},412:function(e,t,n){"use strict";n.d(t,"m",(function(){return I})),n.d(t,"l",(function(){return A})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return z})),n.d(t,"b",(function(){return M})),n.d(t,"e",(function(){return N})),n.d(t,"h",(function(){return P})),n.d(t,"k",(function(){return F})),n.d(t,"j",(function(){return E})),n.d(t,"g",(function(){return R})),n.d(t,"n",(function(){return D})),n.d(t,"d",(function(){return V})),n.d(t,"f",(function(){return L})),n.d(t,"i",(function(){return B}));var a,o,i,r,l,c,s,d,b,u,p,j,x,m,h=n(8),g=(n(1),n(46)),f=n(1056),O=n(1064),v=n(1065),y=n(107),k=n(433),w=n.n(k),C=n(21),T=n(0);const I=Object(g.a)(y.a)(a||(a=Object(h.a)(["\n  margin-bottom: 20px;\n  padding-bottom: 0 !important;\n"]))),A=Object(g.a)("h3")(o||(o=Object(h.a)(["\n  font-family: PingFangSC-Semibold, sans-serif;\n  font-style: normal;\n  font-weight: 550;\n  font-size: 22px;\n  line-height: 31px;\n  color: #000000;\n  margin-bottom: 10px;\n"]))),S=Object(g.a)((e=>Object(T.jsx)(f.a,{disableGutters:!0,elevation:0,square:!0,...e})))((()=>({borderBottom:".2px solid #a5a5a5",background:"unset",boxShadow:"none","&:last-child":{borderBottom:0},"&:before":{display:"none"},".MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(45deg)"}}))),z=Object(g.a)((e=>Object(T.jsx)(O.a,{expandIcon:Object(T.jsx)(w.a,{style:{color:"#2AA1FF"}}),...e})))((()=>({padding:0,"& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(45deg)"},"& .MuiAccordionSummary-content":{margin:"20px 0",p:{color:"#000",fontSize:"1rem",fontFamily:"PingFangSC-Semibold, sans-serif",fontWeight:600,lineHeight:"22px"}}}))),M=Object(g.a)(v.a)((()=>({padding:"0 0 30px 0",transition:".3s"}))),N=(Object(g.a)("div")(i||(i=Object(h.a)(["\n  display: flex;\n  justify-content: space-between;\n"]))),Object(g.a)(C.c)(r||(r=Object(h.a)(["\n  display: block !important;\n  background: linear-gradient(90deg, #61c2f7 0%, #7ae9f0 100%);\n  border-radius: 20px !important;\n  color: #000;\n  width: 30% !important;\n  margin: 0 auto !important;\n  box-shadow: none !important;\n"])))),P=(Object(g.a)(C.c)(l||(l=Object(h.a)(["\n  display: block !important;\n  background: linear-gradient(90deg, #61c2f7 0%, #7ae9f0 100%);\n  border-radius: 20px !important;\n  color: #000;\n  //width: 30% !important;\n  margin: 0 auto !important;\n  box-shadow: none !important;\n"]))),Object(g.a)("div")(c||(c=Object(h.a)(["\n  display: flex;\n  flex-direction: column;\n  margin: 20px 0;\n\n  div {\n    display: flex;\n    margin-bottom: 10px;\n    font-size: 12px;\n    color: rgba(0, 0, 0, 0.5);\n\n    p + p {\n      margin-left: 20px;\n    }\n  }\n\n  .days {\n    margin: 0;\n  }\n"]))),Object(g.a)("div")(s||(s=Object(h.a)(["\n  display: flex;\n  flex-direction: column;\n  width: calc(100% / 2 - 25px);\n\n  p {\n    height: 28px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 15px;\n    box-sizing: border-box;\n\n    span {\n      font-size: 12px;\n      line-height: 17px;\n      color: rgba(0, 0, 0, 0.5);\n    }\n  }\n"]))),Object(g.a)("strong")(d||(d=Object(h.a)(["\n  font-family: PingFangSC-Regular, sans-serif;\n  font-weight: 400;\n  display: block;\n  width: 16px;\n  height: 16px;\n  font-size: 12px;\n  background: #c4c4c4;\n  line-height: 16px;\n  text-align: center;\n  border-radius: 50%;\n  flex: none;\n"])))),F=Object(g.a)("div")(b||(b=Object(h.a)(["\n  display: flex;\n  align-items: center;\n  font-size: 14px;\n  line-height: 20px;\n  color: rgba(0, 0, 0, 0.5);\n  background: #f1f1f1;\n  border-radius: 8px;\n  padding: 14px 80px 13px 21px;\n  margin-bottom: 20px;\n\n  strong {\n    margin-right: 16px;\n  }\n  * {\n    font-family: PingFangSC-Regular, sans-serif;\n  }\n"]))),E=Object(g.a)("span")(u||(u=Object(h.a)(["\n  font-family: PingFangSC-Regular, sans-serif;\n  font-size: 12px;\n  line-height: 17px;\n  color: rgba(0, 0, 0, 0.5);\n"]))),R=Object(g.a)("div")(p||(p=Object(h.a)(["\n  display: flex;\n"]))),D=(e,t)=>function(n){return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(e,{...n,children:t})})},V=Object(g.a)(C.c)(j||(j=Object(h.a)(["\n  box-shadow: 0px 2px 0px rgba(0, 0, 0, 0.043) !important;\n  border-radius: 14px !important;\n  background: linear-gradient(270deg, #7ae9f1 0%, #61c3f7 100%) !important;\n  border-radius: 14px !important;\n  font-size: 14px !important;\n  height: 32px !important;\n  line-height: 32px !important;\n  color: #000 !important;\n  font-weight: normal !important;\n"]))),L=Object(g.a)("h1")(x||(x=Object(h.a)(["\n  font-family: 'Heebo Medium';\n  font-style: normal;\n  font-weight: 500;\n  font-size: 32px;\n  line-height: 47px;\n  margin-bottom: 14px;\n  color: #000000;\n"]))),B=Object(g.a)("div")(m||(m=Object(h.a)(["\n  height: calc(100vh - 189px);\n  padding-bottom: 100px;\n  overflow-y: scroll;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"])))},413:function(e,t,n){"use strict";var a=n(1),o=n(142);t.a=()=>{const e=Object(a.useContext)(o.a);if(void 0===e)throw new Error("hashPowerToken context undefined");return e}},425:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(1);var a=n(0);function o(e){return Object(a.jsx)("img",{...e.imgprops,src:e.token,alt:e.symbol})}},429:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));n(1);var a=n(9),o=n(412),i=n(0);const r=e=>{let{txHash:t,content:n}=e;return Object(i.jsxs)("div",{children:[Object(i.jsx)("p",{style:{marginBottom:24},children:n}),Object(i.jsx)(o.g,{style:{flexDirection:"row-reverse"},children:Object(i.jsx)(o.d,{onClick:()=>{window.open("".concat(a.e,"/").concat(t))},children:"View on Explorer"})})]})},l=e=>{let{txHash:t,content:n}=e;return Object(i.jsxs)("div",{children:[Object(i.jsx)("p",{style:{marginBottom:24},children:n}),Object(i.jsx)(o.g,{style:{flexDirection:"row-reverse"},children:Object(i.jsx)(o.d,{onClick:()=>{window.open("".concat(a.e,"/").concat(t))},children:"View on Explorer"})})]})}},434:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return m}));var a=n(37),o=n(25),i=n(474),r=n(1),l=n(23),c=n(92),s=n(140),d=n(29),b=n(93),u=n(213);function p(){const{account:e,chainId:t}=Object(o.b)(),n=Object(a.c)((e=>e.short.activeInfo)),{currentPosition:u}=Object(s.c)(),{onCheckApprove:p}=Object(i.b)(),{handleApprove:j}=Object(i.a)(e,n.token?l.b[n.token].address[t]:"0"),[x,m]=Object(r.useState)(!1),{toastError:h}=Object(c.a)();Object(r.useEffect)((()=>{n.token&&p(e,d.e[t].tokens[d.h[n.token]].address,u.positionAddress).then((e=>{e&&e._hex>0?m(!0):m(!1)})).catch((()=>{m(!1)}))}),[e,n,t,u.positionAddress,p]);return{approveStatus:x,onApprove:Object(r.useCallback)((async()=>{try{m(!0);return await j(u.positionAddress)}catch({message:e,reason:t}){return m(!1),h(b.e.failed,"".concat(t)),e}}),[j,u.positionAddress,h])}}function j(){const e=Object(a.b)(),{activeAmount:t,activeInfo:n,activeIndex:o}=Object(a.c)((e=>e.short)),{pendingActionList:i}=x(),l=Object(r.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(Object(u.e)({activeInfo:t}));const n=i.findIndex((e=>e.token===t.token&&e.tokenType===t.tokenType));n>=0&&e(Object(u.f)({index:n}))}),[e,i]),c=Object(r.useCallback)((t=>{e(Object(u.h)({index:t}))}),[e]),s=Object(r.useCallback)((t=>{e(Object(u.f)({index:t}))}),[e]),d=Object(r.useCallback)((t=>{e(Object(u.g)({amount:t}))}),[e]),b=Object(r.useCallback)((()=>{l(),d(""),s(-1)}),[s,l,d]),p=Object(r.useMemo)((()=>null!==n&&void 0!==n&&n.token?{...n,amount:t,activeIndex:o}:{token:null,amount:"",tokenType:null,activeIndex:-1,approveStatus:!1}),[t,o,n]),j=Object(r.useCallback)((t=>{let{ratio:n,coverage:a}=t;e(Object(u.i)({rateInfo:{rate:n,coverage:a}}))}),[e]);return{setActionInfo:l,setActiveAmount:d,clearActive:b,setActiveTab:c,activeInfo:p,setActionIndex:s,onChangeCollateralIndex:j}}function x(){const e=Object(a.b)(),{pendingActions:t}=Object(a.c)((e=>e.short)),n=Object(r.useMemo)((()=>new Map(t)),[t]),o=Object(r.useCallback)((t=>{const a=n.get(t.token)||[];n.set(t.token,[...a,{...t,type:u.a.ADD}]),e(Object(u.d)({actions:n}))}),[e,n]),i=Object(r.useCallback)(((t,a)=>{const o=[...n.get(t)||[]].filter((e=>e.tokenType!==a));n.set(t,o),e(Object(u.d)({actions:n}))}),[e,n]),l=Object(r.useCallback)((()=>{e(Object(u.d)({actions:new Map}))}),[e]),c=Object(r.useCallback)((t=>{const a=[...n.get(t.token)||[]],o=a.findIndex((e=>e.tokenType===t.tokenType));a.splice(o,1,{...t,type:u.a.ADD}),n.set(t.token,a),e(Object(u.d)({actions:n}))}),[n,e]),s=Object(r.useCallback)((t=>{const a=[...n.get(t.token)||[]],o=a.findIndex((e=>e.neutralizeType===t.neutralizeType));a.splice(o,1,{...t,type:u.a.ADD}),n.set(t.token,a),e(Object(u.d)({actions:n}))}),[n,e]),d=Object(r.useCallback)(((t,a)=>{const o=[...n.get(t)||[]].filter((e=>e.neutralizeType!==a));n.set(t,o),e(Object(u.d)({actions:n}))}),[e,n]),b=Object(r.useMemo)((()=>{const e=new Map;return t.forEach(((t,n)=>{e.set(n,t.map((e=>e.tokenType)))})),e}),[t]),p=Object(r.useMemo)((()=>Array.from(t.values()).flat()),[t]),j=Object(r.useMemo)((()=>{const e={};return p.forEach((t=>{t.tokenType!==u.b.SUPPLY&&t.tokenType!==u.b.WithDraw||(e[t.token]=t.amount)})),e}),[p]),x=Object(r.useMemo)((()=>{let e=0;return p.forEach((t=>{t.tokenType===u.b.SHORT&&(e=t.amount)})),e}),[p]),m=Object(r.useMemo)((()=>{let e=0;return p.forEach((t=>{t.tokenType===u.b.NEUTRALIZE&&(e+=t.amount)})),e}),[p]),h=Object(r.useMemo)((()=>{let e=0;return p.forEach((t=>{t.tokenType===u.b.SUPPLY&&(e+=t.amount)})),e}),[p]),g=Object(r.useMemo)((()=>{const e=new Map;return t.forEach((t=>{const n=t.filter((e=>e.tokenType===u.b.SUPPLY))[0];n&&e.set(n.token,n.amount)})),e}),[t]);return{addPendingAction:o,clearAllPendingAction:l,deletePendingAction:i,updatePendingAction:c,deleteNeutralizePendingAction:d,updateNeutralizePendingAction:s,pendingTokenTypes:b,pendingActions:t,pendingActionList:p,tokenAmount:j,shortAmount:x,supplyAmount:g,supplyAllAmount:h,neutralizeAmount:m}}function m(){const{rateInfo:e,activeTab:t,activeInfo:n}=Object(a.c)((e=>e.short)),o=Object(a.b)();return{rateInfo:e,onChangeCollateralIndex:Object(r.useCallback)((e=>{let{ratio:t,coverage:n}=e;o(Object(u.i)({rateInfo:{rate:t,coverage:n}}))}),[o]),activeTab:t,activeInfo:n}}},474:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var a=n(25),o=n(1),i=n(16),r=n(12),l=n(79),c=n(108);function s(){const{active:e}=Object(a.b)(),{signer:t}=Object(c.a)();return{onCheckApprove:Object(o.useCallback)((async(n,a,o)=>{if(e)try{console.log("handleApprove",1);const e=Object(r.b)(t,l,a);if(e){return await e.allowance(n,o)}}catch(i){return console.error("Failed to check approval",i),null}return null}),[e,t])}}function d(e,t){const{active:n,library:c,chainId:s}=Object(a.b)();return{handleApprove:Object(o.useCallback)((async a=>{if(n&&s){const n=Object(r.e)(c,e),o=Object(r.b)(n,l,t&&"object"===typeof t?t[s]:t);if(o)return o.approve(a,i.a.constants.MaxUint256)}return null}),[n,s,c,e,t])}}},595:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const a={days:10,ratio:110},o={days:20,ratio:120}}}]);
//# sourceMappingURL=18.ad7a8abf.chunk.js.map