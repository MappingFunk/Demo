(this["webpackJsonpmappingfunk-interface"]=this["webpackJsonpmappingfunk-interface"]||[]).push([[18],{1046:function(e,t,n){"use strict";n.r(t);var a,o,i,l,r,c,s,d,b,u,j,p=n(7),m=n(1),x=n(1059),h=n(79),g=n(18),f=n(125),O=n(228),v=n(28),y=n(457),k=n(225),I=n(39),w=n(19),T=n(15),C=n(144),A=n(16),S=n(45),N=n(447),z=n(96),M=n(433),P=n(1053);const E=Object(g.a)(M.a)(a||(a=Object(p.a)(["\n  height: 32px;\n  padding: 0 16px;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 32px;\n  border-radius: 20px;\n  text-transform: none;\n  color: rgba(0, 0, 0, 1);\n  background: linear-gradient(90deg, rgba(97, 194, 247, 1) 0%, rgba(122, 233, 240, 1) 100%);\n"]))),F=Object(g.a)("div")(o||(o=Object(p.a)(["\n  .MuiSlider-markLabel {\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n    }\n  }\n"]))),R=Object(g.a)("div")(i||(i=Object(p.a)(["\n  position: relative;\n  width: 100%;\n\n  .custom_range_flag {\n    font-size: 12px;\n    transform: translateX(-50%);\n    position: absolute;\n    top: 6px;\n    left: ",";\n    height: 24px;\n    width: fit-content;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    border-radius: 23px;\n    padding: 0 5px;\n    line-height: 24px;\n    &::before {\n      position: absolute;\n      content: '';\n      left: 2px;\n      top: 2px;\n      right: 2px;\n      bottom: 2px;\n      background-color: #fff;\n      border-radius: 20px;\n    }\n    .range_val {\n      position: relative;\n      z-index: 1;\n    }\n  }\n  &.feature_item {\n    .custom_range_flag {\n      top: -26px;\n    }\n  }\n"])),(e=>e.value>300||"+\u221e"===e.value?"calc(100% - 5%)":"calc((100% - 5%) / 300 * ".concat(e.value,")"))),D=Object(g.a)(P.a)(l||(l=Object(p.a)(["\n  height: 10px;\n  width: 95%;\n\n  .MuiSlider-valueLabel:before {\n    display: none;\n  }\n  .MuiSlider-valueLabel {\n    height: 24px;\n    width: 36px;\n    font-size: 12px;\n    background-color: #fff;\n    border-radius: 20px;\n    border: 2px solid #61c2f7;\n    color: #000;\n    transform: translate(0, 10px) !important;\n  }\n  .MuiSlider-rail {\n    background: rgba(212, 230, 242, 1);\n  }\n\n  .MuiSlider-track {\n    border: none;\n    background: linear-gradient(-90deg, #8cdb65, #ffcc04 40%, #ff6308);\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n    height: 24px;\n    width: 24px;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    &:focus,\n    &:hover,\n    &.Mui-active,\n    &.Mui-focusVisible {\n      box-shadow: inherit;\n    }\n\n    &::before {\n      background-color: #fff;\n      width: 20px;\n      height: 20px;\n      left: calc(50% - 10px);\n      top: calc(50% - 10px);\n    }\n    &::after {\n      content: '';\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      background: #2aa1ff;\n      box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    }\n  }\n\n  .MuiSlider-mark {\n    &[data-index='0'] {\n      opacity: 0;\n    }\n    &[data-index='3'] {\n      display: none !important;\n    }\n\n    top: 5px;\n    height: 7.5px;\n    background-color: #969696;\n  }\n\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='0'] {\n      left: 10px !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n    }\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n  }\n"]))),V=Object(g.a)(P.a)(r||(r=Object(p.a)(["\n  height: 10px;\n  width: 95%;\n  margin-top: -30px;\n  transition: all 0.3s ease;\n  .css-1kz0hui-MuiSlider-valueLabel:before {\n    display: none;\n  }\n  .css-1kz0hui-MuiSlider-valueLabel {\n    height: 24px;\n    width: 36px;\n    font-size: 12px;\n    background-color: #fff;\n    border-radius: 20px;\n    border: 2px solid #61c2f7;\n    color: #000;\n    transform: translate(0, 10px);\n  }\n  .MuiSlider-rail {\n    background: rgba(212, 230, 242, 1);\n  }\n\n  .MuiSlider-track {\n    border: none;\n    background: linear-gradient(-90deg, #8cdb65, #ffcc04 40%, #ff6308);\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n    height: 24px;\n    width: 24px;\n    box-shadow: 0 4px 15px 1px rgba(0, 0, 0, 0.07);\n    background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n\n    &:focus,\n    &:hover,\n    &.Mui-active,\n    &.Mui-focusVisible {\n      box-shadow: inherit;\n    }\n\n    &::before {\n      background-color: #fff;\n      width: 20px;\n      height: 20px;\n      left: calc(50% - 10px);\n      top: calc(50% - 10px);\n    }\n\n    &::after {\n      content: '';\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      background: #2aa1ff;\n      box-shadow: 0 4px 4px rgba(42, 161, 255, 0.25);\n    }\n  }\n  .MuiSlider-mark {\n    display: none !important;\n  }\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='0'] {\n      left: 10px !important;\n    }\n    &[data-index='2'] {\n      font-weight: bold;\n      transform: translateX(0) !important;\n      color: rgba(0, 0, 0, 1) !important;\n    }\n    &[data-index='1'] {\n      transform: translateX(-100%) !important;\n    }\n  }\n"]))),L=Object(g.a)(P.a)(c||(c=Object(p.a)(["\n  padding-bottom: 20px;\n  padding-top: 10px;\n  margin-top: -20px;\n  height: 0;\n  width: 95%;\n\n  .MuiSlider-rail {\n    display: none;\n  }\n\n  .MuiSlider-track {\n    display: none;\n  }\n\n  .MuiSlider-thumb {\n    display: none;\n  }\n\n  .MuiSlider-mark {\n    display: none;\n  }\n  .MuiSlider-markLabel {\n    font-size: 12px;\n    color: rgba(0, 0, 0, 1) !important;\n\n    &[data-index='2'] {\n      font-weight: bold;\n      color: rgba(0, 0, 0, 1) !important;\n    }\n  }\n"]))),B={display:"flex",justifyContent:"space-between",alignItems:"start"},H=Object(g.a)(z.a)(s||(s=Object(p.a)(["\n  margin-bottom: 20px;\n  display: block;\n  width: 58%;\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),U=Object(g.a)(z.a)(d||(d=Object(p.a)(["\n  margin-bottom: 20px;\n  display: flex;\n  width: 40%;\n  /* opacity */\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),_=Object(g.a)("div")(b||(b=Object(p.a)(["\n  width: 100%;\n  input {\n    width: 100%;\n    border: unset;\n    outline: unset;\n    background-color: unset;\n    font-family: PingFang SC;\n    font-size: 24px;\n    font-weight: 600;\n    line-height: 33.6px;\n    text-align: left;\n    color: rgba(0, 0, 0, 1);\n  }\n  input::-webkit-inner-spin-button {\n    display: none;\n  }\n  input::placeholder {\n    color: rgba(0, 0, 0, 0.2);\n  }\n"]))),W={tableHeader:{fontSize:12,fontWeight:500,color:"rgba(0, 0, 0, 0.6)"},tableHeadCell:{pl:0,pr:0,pb:0},tableBody:{borderBottom:"1px solid rgba(47, 0, 0, 0.13)"},tableBodyRow:{"&:last-child td, &:last-child th":{border:0},transition:"all 0.3s",":hover":{backgroundColor:"rgba(110, 214, 243, 0.13)"}},tableBodyCell:{display:"flex",alignItems:"center",pl:1,pr:0,height:66,cursor:"pointer"},clearAll:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"}},Y={box:{width:"100%",overflow:"hidden",overflowX:"scroll","&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-track:hover":{backgroundColor:"#f1f1f1"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},topBox:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:3}},Z={addAdnRemoveBtn:{color:"#000",width:32,height:32,background:"linear-gradient(90deg, #29A0FF 0%, #7AE8F1 100%)",backgroundSize:"100% 100%"}},X=Object(g.a)("div")(u||(u=Object(p.a)(["\n  display: flex;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.03);\n  border-radius: 8px;\n  padding: 16px 20px;\n  margin-top: 10px;\n  p {\n    line-height: 20px;\n    font-size: 14px;\n    font-family: PingFangSC-Regular, sans-serif;\n    margin-left: 16px;\n    color: rgba(0, 0, 0, 0.5);\n  }\n"]))),q=Object(g.a)("div")(j||(j=Object(p.a)(["\n  margin-top: 34px;\n  .title-neutralize {\n    font-size: 16px;\n    font-family: PingFangSC-Medium, sans-serif;\n    margin-bottom: 16px;\n    font-size: 500;\n  }\n  .content {\n    display: flex;\n  }\n  .item_wrap {\n    min-width: 200px;\n    padding: 1px;\n    border-radius: 14px;\n    overflow: hidden;\n    margin-right: 16px;\n    background: #e3e8ed;\n    cursor: pointer;\n    user-select: none;\n    span {\n      font-family: PingFangSC-Regular, sans-serif;\n      color: rgba(0, 0, 0, 0.5);\n      font-size: 12px;\n      line-height: 17px;\n      &:first-of-type {\n        margin-right: 30px;\n      }\n    }\n    &.active {\n      padding: 2px;\n      background: linear-gradient(270deg, #7ae9f0 0%, #61c3f7 100%);\n      span {\n        color: #000;\n      }\n    }\n  }\n  .item {\n    border-radius: 12px;\n    //border: 2px solid #E3E8ED;\n    //border-image: linear-gradient(#7AE9F0 , #61C3F7) 30 30;\n    padding: 14px 14px 9px 10px;\n    background: #fff;\n    width: 100%;\n    height: 100%;\n    //box-sizing: border-box;\n    h4 {\n      font-family: PingFangSC-Semibold, sans-serif;\n      font-weight: 550;\n      display: flex;\n      align-items: center;\n      line-height: 20px;\n      font-size: 14px;\n      margin-bottom: 22px;\n      svg {\n        margin-right: 8.5px;\n      }\n    }\n    p {\n      display: flex;\n      justify-content: space-between;\n    }\n  }\n"])));var G,J,K,$,Q,ee,te,ne,ae,oe=n(0);function ie(e){const{value:t}=e,[n,a]=Object(m.useState)({rate:0,coverage:0});Object(m.useEffect)((()=>{t&&(null!==t&&void 0!==t&&t.marks1&&(null===t||void 0===t?void 0:t.marks1.length)>0?a({rate:null===t||void 0===t?void 0:t.defaultvalue,coverage:0}):a({rate:0,coverage:null===t||void 0===t?void 0:t.defaultvalue}))}),[t]);const o=Object(m.useCallback)((e=>{let t=e;return"Infinity"===t||t===1/0||"+\u221e"===t?"+\u221e":(t=Number(t),0!==t&&t?t&&-1!==t.toString().indexOf("%")?"".concat(t.replace(/%/g,""),"%"):"".concat(t,"%"):0)}),[]),i=Object(m.useMemo)((()=>{const e=n.coverage;return"Infinity"===e||e===1/0||"+\u221e"===e?"+\u221e":0!==e&&e?"".concat(e):0}),[n.coverage]),l=Object(m.useMemo)((()=>{const e="Infinity"===n.coverage||"N/A"===n.coverage||n.coverage===1/0||"+\u221e"===n.coverage||"NAN"===n.coverage.toString()||Number(n.coverage)>300?300:Number(n.coverage),t=e>0?e:0,a=t<=10?11*t:6*(t-10)+100,o="Infinity"===n.rate||n.rate===1/0||"+\u221e"===n.rate||"NAN"===n.rate.toString()||Number(n.rate)>300?300:n.rate,i=Number(o)>0?o:0;return{rate:Number(i)<=110?Number(i):3*(Number(i)-100)+100,coverage:a}}),[n.coverage,n.rate]);return Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)("div",{className:"range_wrap",children:[Object(oe.jsx)(F,{className:"custom-slider-wrapper",children:Object(oe.jsx)(L,{valueLabelDisplay:"off","aria-label":"pretto slider",value:Number(n.rate),marks:t.marks1,max:300})}),t.marks1.length>0?Object(oe.jsxs)(R,{value:l.rate,children:[Object(oe.jsx)(D,{disabled:!0,"aria-label":"pretto slider",defaultValue:120,value:l.rate,max:300,valueLabelDisplay:"on",marks:t.marks,sx:{".css-1qlnp9f-MuiSlider-root .MuiSlider-markLabel[data-index='1']":{pr:70},".css-1qlnp9f-MuiSlider-root .MuiSlider-markLabel[data-index='2']":{pl:70}}}),Object(oe.jsx)("div",{className:"custom_range_flag",children:Object(oe.jsx)("div",{className:"range_val",children:"".concat(o(n.rate))})})]}):Object(oe.jsxs)(R,{className:"feature_item",value:Number(l.coverage),children:[Object(oe.jsx)(V,{disabled:!0,"aria-label":"pretto slider",defaultValue:20,value:l.coverage,valueLabelDisplay:"on",marks:t.marks,max:300}),Object(oe.jsx)("div",{className:"custom_range_flag",children:Object(oe.jsx)("div",{className:"range_val",children:i})})]})]})})}const le=Object(g.a)(z.a)(G||(G=Object(p.a)(["\n  margin-bottom: 20px;\n  display: flex;\n  height: 175px;\n  width: 100%;\n  box-shadow: 0 4px 27px rgba(0, 0, 0, 0.03);\n  backdrop-filter: unset;\n"]))),re=Object(g.a)("div")(J||(J=Object(p.a)(["\n  width: 30%;\n"]))),ce=Object(g.a)("div")(K||(K=Object(p.a)(["\n  width: 70%;\n"]))),se=Object(g.a)("div")($||($=Object(p.a)(["\n  color: rgba(0, 0, 0, 0.5);\n"]))),de=Object(g.a)("div")(Q||(Q=Object(p.a)(["\n  margin-top: 10px;\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.5);\n"]))),be=Object(g.a)("div")(ee||(ee=Object(p.a)(["\n  margin-bottom: 14px;\n  font-family: PingFangSC-Semibold, sans-serif;\n  font-weight: 550;\n  font-size: 35px;\n  margin-top: 24px;\n  line-height: 35px;\n  color: #000000;\n"]))),ue=Object(g.a)("div")(te||(te=Object(p.a)(["\n  display: flex;\n"]))),je=Object(g.a)("div")(ne||(ne=Object(p.a)(["\n  width: 25%;\n"]))),pe=Object(g.a)("div")(ae||(ae=Object(p.a)(["\n  width: 75%;\n"])));var me=function(){const[e,t]=Object(m.useState)({marks1:[{value:0,label:""},{value:110,label:"Liquidation"},{value:160,label:"Min. Mint"},{value:300,label:""}],marks:[{value:0,label:""},{value:110,label:"110%"},{value:160,label:"120%"},{value:300,label:""}]}),[n,a]=Object(m.useState)({marks1:[],marks:[{value:0,label:""},{value:110,label:"10"},{value:160,label:"20"},{value:300,label:""}]}),{currentPosition:o,currentPositionTokenInfo:i}=Object(C.c)(),{newCollateralRatio:l,newPrepaidInterestCoverage:r,onUpdateNeutralizeValue:c}=Object(C.a)(),{shortAmount:s,neutralizeAmount:d}=Object(y.d)(),{activeInfo:b}=Object(y.a)(),{rateInfo:u}=Object(y.c)(),[j,p]=Object(m.useState)(!1),{activeTab:x}=Object(y.c)();Object(m.useEffect)((()=>{let{coverage:e,rate:n}=u;1===x?s&&(u.rate<120?e="N/A":u.rate>=120&&e<20&&(e=20)):2===x&&(e=T.a.formatTokenAmount(r,0),n=T.a.formatTokenAmount(l,2)),a((t=>({...t,defaultvalue:e,showValue:e}))),t((e=>({...e,defaultvalue:n,showValue:n}))),p(!0)}),[x,l,r,u,s]);const h=Object(m.useMemo)((()=>{var e;return i.tokenPrice?Object(T.b)(null===(e=i.tokenPrice[o.mintTokenInfo.symbol])||void 0===e?void 0:e.price,o.mintTokenInfo.settlementCurrency.decimals):0}),[o,i]);return Object(m.useEffect)((()=>{if((null===b||void 0===b?void 0:b.tokenType)===k.b.NEUTRALIZE){const e=Number(null===b||void 0===b?void 0:b.amount);c(e?Number("-".concat(e)):0)}else if(d&&(null===b||void 0===b?void 0:b.tokenType)===k.b.NEUTRALIZE){const e=Number(d);c(e?Number("-".concat(e)):0)}}),[b,c,d,x]),Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)(le,{children:[Object(oe.jsxs)(re,{children:[Object(oe.jsx)(se,{children:"Outstanding Debt"}),Object(oe.jsx)(be,{children:T.a.formatFourDecimals(Number(Object(T.b)(o.balance,o.mintTokenInfo.decimals)))}),Object(oe.jsxs)(de,{children:["Mark Price: ",h," WBTC"]})]}),j&&Object(oe.jsxs)(ce,{children:[Object(oe.jsxs)(ue,{children:[Object(oe.jsx)(je,{style:{marginTop:"45px"},children:"Collateral Ratio"}),Object(oe.jsx)(pe,{children:Object(oe.jsx)(ie,{value:e},1)})]}),Object(oe.jsxs)(ue,{children:[Object(oe.jsx)(je,{children:"Prepaid Interest Coverage"}),Object(oe.jsx)(pe,{children:Object(oe.jsx)(ie,{value:n},2)})]})]})]})})},xe=n(1069),he=n(1070),ge=n(1038),fe=n(1068),Oe=n(1067),ve=n(1066),ye=n(436),ke=n(715),Ie=n(1002),we=n(510),Te=n.n(we),Ce=n(995),Ae=n.n(Ce),Se=n(442);const Ne=e=>{let{state:t,val:n,token:a}=e;const{clearActive:o,setActionInfo:i,setActiveAmount:l}=Object(y.a)();return Object(oe.jsxs)(x.a,{sx:{width:74,height:32,borderRadius:10,border:"1px solid rgba(70, 79, 96, 0.2)",color:"rgba(134, 143, 160, 1)",display:"flex",alignItems:"center",background:"rgba(247, 249, 252, 1)",justifyContent:"space-between",p:1,cursor:"pointer",transition:"all 0.3s"},onClick:()=>{"close"===t&&o(),"up"===t&&(i({token:a,tokenType:k.b.SUPPLY}),l(Number(n))),"down"===t&&(i({token:a,tokenType:k.b.WithDraw}),l(Number(n)))},children:["up"===t&&Object(oe.jsx)("span",{style:{fontWeight:100,fontSize:"18px"},children:"+"}),"close"===t&&Object(oe.jsx)(Ae.a,{sx:{width:12,height:12}}),"down"===t&&Object(oe.jsx)("span",{style:{fontWeight:100,fontSize:"18px"},children:"-"}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,mt:.1,width:"40px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"right"},children:n})]})},ze=e=>{var t,n;let{pendingTokenTypes:a,symbol:o,tokenAmount:i}=e;const{activeInfo:l,setActionInfo:r}=Object(y.a)(),{walletTokenBalance:c}=Object(Se.a)(),s=Object(m.useMemo)((()=>c&&0===c[o]),[c,o]);return l.token!==o||l.tokenType!==k.b.SUPPLY&&l.tokenType!==k.b.WithDraw?null!==(t=a.get(o))&&void 0!==t&&t.includes(k.b.SUPPLY)?Object(oe.jsx)(Ne,{token:o,state:"up",val:i[o]}):null!==(n=a.get(o))&&void 0!==n&&n.includes(k.b.WithDraw)?Object(oe.jsx)(Ne,{token:o,state:"down",val:i[o]}):Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsx)(Ie.a,{disabled:s,onClick:()=>{s||r({token:o,tokenType:k.b.SUPPLY})},sx:Z.addAdnRemoveBtn,children:Object(oe.jsx)(Te.a,{sx:{fontSize:16}})})}):Object(oe.jsx)(Ne,{token:o,state:"close",val:l.tokenType})};var Me=()=>{const{walletTokenBalance:e}=Object(Se.a)(),{pendingActionList:t,tokenAmount:n}=Object(y.d)(),a=Object(m.useMemo)((()=>{const e=new Map;return t.forEach((t=>{const n=e.get(t.token)||[];n.push(t.tokenType),e.set(t.token,n)})),e}),[t]),{currentPositionTokenInfo:o,currentPosition:i}=Object(C.c)(),l=Object(m.useMemo)((()=>{if(o.allowedTokens){const{tokens:e,balances:t}=o.allowedTokens;return Object.keys(e).map((n=>{var a,o,i,l;return{symbol:null===(a=e[n])||void 0===a?void 0:a.symbol,address:null===(o=e[n])||void 0===o?void 0:o.address,icon:()=>{var t,a;return Object(oe.jsx)(N.a,{imgprops:{style:{marginRight:10}},token:null===(t=e[n])||void 0===t?void 0:t.logo,symbol:null===(a=e[n])||void 0===a?void 0:a.symbol})},decimals:null===(i=e[n])||void 0===i?void 0:i.decimals,balance:Object(T.b)(t[n]||0,null===(l=e[n])||void 0===l?void 0:l.decimals,!0)}}))}return[]}),[o]),r=Object(m.useCallback)((e=>{var t;const n=null===(t=o.tokenPrice[e.symbol])||void 0===t?void 0:t.price;return n?e.balance*Object(T.b)(n,i.mintTokenInfo.settlementCurrency.decimals,!0):0}),[i.mintTokenInfo.settlementCurrency.decimals,o.tokenPrice]);return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(xe.a,{sx:{},"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:{fontSize:12,fontWeight:500,color:"rgba(0, 0, 0, 0.6)"},children:[Object(oe.jsx)(ge.a,{sx:{pl:0,pr:0},children:"Collateral Asset"}),Object(oe.jsx)(ge.a,{align:"right",sx:{pl:0,pr:0},children:"Collateral Balance"}),Object(oe.jsx)(ge.a,{align:"right",sx:{pl:0,pr:0},children:null})]})}),Object(oe.jsx)(he.a,{children:l.map((t=>Object(oe.jsxs)(ve.a,{sx:{"&:last-child td, &:last-child th":{border:0,transition:"all 0.3s"}},children:[Object(oe.jsxs)(ge.a,{sx:{display:"flex",alignItems:"center",pl:0,pr:0,height:66},children:[Object(oe.jsx)(t.icon,{}),Object(oe.jsxs)("div",{style:{marginLeft:"10px"},children:[Object(oe.jsx)(ke.a,{sx:{fontWeight:600},children:t.symbol}),Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(0, 0, 0, 0.5)"},children:[t.symbol," ",T.a.formatFourDecimals(e[t.symbol])," in wallet"]})]})]}),Object(oe.jsxs)(ge.a,{align:"right",sx:{p:0,height:66,transition:"all 0.3s"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:T.a.formatFourDecimals(t.balance)}),0!==e[t.symbol]&&Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(53, 5, 5, 0.5)"},children:[T.a.formatFourDecimals(r(t))," ",i.mintTokenInfo.settlementCurrency.symbol]})]}),Object(oe.jsx)(ge.a,{sx:{pl:0,pr:0,height:66},children:Object(oe.jsx)(x.a,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:Object(oe.jsx)(ze,{pendingTokenTypes:a,symbol:t.symbol,tokenAmount:n})})})]},t.symbol)))})]})})},Pe=n(1055),Ee=n(996),Fe=n.n(Ee),Re=n(711),De=n.n(Re),Ve=n(26),Le=n(110),Be=n(60),He=n(67),Ue=n(14),_e=n(11),We=n(227),Ye={"F(BTC,20)":w.j,"F(BTC,25)":w.j,WBTC:w.B,USDT:w.A,wallet:We.a,avatar:w.b},Ze=n(95),Xe=n(10),qe=n(149),Ge=n(30),Je=n(111),Ke=n(94),$e=n(221),Qe=n(1049),et=n(1072),tt=n(997);var nt=e=>{let{handleClose:t,anchorEl:n,open:a,deadline:o,maxSlippageValue:i,setMaxSlippageValue:l,setDeadlineValue:r}=e;const[c,s]=Object(m.useState)(!1),[d,b]=Object(m.useState)(!1),[u,j]=Object(m.useState)(!1);return Object(oe.jsxs)(tt.a,{id:"basic-menu",anchorEl:n,open:a,onClose:t,MenuListProps:{"aria-labelledby":"basic-button"},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},PaperProps:{sx:{width:"288px",boxShadow:"none",mt:1.5,borderRadius:2,border:"1px solid rgba(207, 216, 226, 0.5)"}},children:[Object(oe.jsxs)(x.a,{sx:{pl:1.2,pr:1.2,mb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 0.5)"},children:"Max.slippage"}),Object(oe.jsx)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}})]}),Object(oe.jsxs)(x.a,{sx:{display:"flex",gap:1,pl:1.2,pr:1.2,height:50,width:268,alignItems:"center",ml:"9.6px",border:"1px solid #CFD8E2",borderRadius:2.6},children:[Object(oe.jsx)(x.a,{onClick:()=>{l("0.1"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:2.5,background:"0.1"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",height:"42px",width:"42px",fontSize:"12px"},children:"0.1%"}),Object(oe.jsx)(x.a,{onClick:()=>{l("0.5"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",background:"0.5"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",borderRadius:2.5,height:"42px",width:"42px",fontSize:"12px"},children:"0.5%"}),Object(oe.jsx)(x.a,{onClick:()=>{l("1"),b(!0)},sx:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:2.5,background:"1"===i?"linear-gradient(270deg, #7AE8F1 0%, #29A0FF 100%)":"",cursor:"pointer",height:"42px",width:"42px",fontSize:"12px"},children:"1%"}),Object(oe.jsx)(x.a,{sx:{flex:1.2,display:"flex",alignItems:"center",borderRadius:2,border:c||i>0&&"0.5"!==i&&"0.1"!==i&&"1"!==i?"1px solid rgba(110, 214, 243, 1)":"1px solid rgba(207, 216, 226, 0.5)",p:1},children:Object(oe.jsx)(Qe.a,{placeholder:"1",multiline:!0,maxRows:5,size:"small",onBlur:()=>s(!1),onFocus:()=>s(!0),value:i,onChange:e=>{let t="";const n=e.target.value.replace(/[^\d.]/g,"");if(n.includes(".")){var a;const e=n.split(".");e[1]=null===(a=e[1])||void 0===a?void 0:a.slice(0,2),t=e.join(".")}else t=n;b(!0),Number(e.target.value)<0||""===e.target.value?l("0"):Number(e.target.value)>49.9?l("49.9"):l(t.includes(".")?t.toString():parseFloat(t).toString())},sx:{"& .MuiInputBase-input":{textAlign:"right",color:d?"":"rgb(0 0 0 / 20%)"},"& .MuiInputBase-input::placeholder":{textAlign:"right"}},variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0,sx:{padding:0},endAdornment:Object(oe.jsx)(et.a,{position:"end",children:Object(oe.jsx)(ke.a,{sx:{textAlign:"left",fontSize:14,fontWeight:400,color:"rgba(0,0,0,1)"},children:"%"})})}})})]}),Object(oe.jsxs)(x.a,{sx:{pl:1.2,pr:1.2,display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:1},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 0.5)"},children:"Transaction deadline"}),Object(oe.jsx)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}})]}),Object(oe.jsx)(x.a,{sx:{height:50,flex:1,display:"flex",alignItems:"center",borderRadius:2,border:"1px solid rgba(207, 216, 226, 0.5)",p:1,ml:1.2,mr:1.2},children:Object(oe.jsx)(Qe.a,{placeholder:"10",multiline:!0,maxRows:5,size:"small",value:o,onChange:e=>{j(!0),r(e.target.value)},sx:{"& .MuiInputBase-input":{textAlign:"right",color:u?"":"rgb(0 0 0 / 20%)"},"& .MuiInputBase-input::placeholder":{textAlign:"right"}},variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0,sx:{padding:0},endAdornment:Object(oe.jsx)(et.a,{position:"end",children:Object(oe.jsx)(ke.a,{sx:{fontSize:14,fontWeight:400,color:"rgba(0, 0, 0, 1)"},children:"minutes"})})}})})]})},at=n(710),ot=n.n(at),it=n(540);var lt,rt,ct=()=>{const{chainId:e}=Object(v.b)(),{tokenPools:t}=Object(Le.a)(),{supplyAllAmount:n,shortAmount:a}=Object(y.d)(),{activeInfo:o}=Object(y.a)(),{rateInfo:i}=Object(y.c)(),{collateralIndex:l,currentPosition:r}=Object(C.c)(),{onUpdateNeutralizeValue:c,onUpdateCollateralValue:s,newOutStandingDebt:d,newEstimatedDailyDebt:b,newDisplayCollateralRatio:u,newPrepaidInterestCoverage:j}=Object(C.a)(),p=Object(m.useMemo)((()=>{const{decimals:e,settlementCurrency:t}=r.mintTokenInfo;return{current:T.a.formatFourDecimals(Number(Object(T.b)(r.balance,e))),next:T.a.formatFourDecimals(Number(Object(T.b)(d,e))),newDisplayCollateralRatio:u,newEstimatedDailyDebt:T.a.formatTokenAmount(b/10**t.decimals,t.decimals)}}),[r.balance,r.mintTokenInfo,u,b,d]),h=Object(m.useMemo)((()=>{if(i.rate>=120&&i.coverage<20){return T.a.formatTokenAmount(Number(p.newEstimatedDailyDebt)*it.b.days,r.mintTokenInfo.settlementCurrency.decimals)}return j}),[r.mintTokenInfo.settlementCurrency.decimals,p.newEstimatedDailyDebt,j,i.coverage,i.rate]),g=Object(m.useMemo)((()=>{let{coverage:e,rate:t}=i;return a?i.rate<120?e=0:i.rate>=120&&e<20?e=20:e!==Number.POSITIVE_INFINITY&&"Infinity"!==e||(e=Number.POSITIVE_INFINITY):e=e===Number.POSITIVE_INFINITY||"Infinity"===e?Number.POSITIVE_INFINITY:l.prepaidInterestCoverage,i.rate?i.rate!==Number.POSITIVE_INFINITY&&"Infinity"!==i.rate||(t=Number.POSITIVE_INFINITY):t=l.collateralRatio,{rate:t,coverage:e}}),[l.collateralRatio,l.prepaidInterestCoverage,i,a]),f=Object(m.useMemo)((()=>{let{coverage:e,rate:t}=i;return e=a?i.rate<120?"N/A":i.rate>=120&&e<20?"".concat(20," days"):e===Number.POSITIVE_INFINITY||"Infinity"===e?"+\u221e":"".concat(e," days"):e===Number.POSITIVE_INFINITY||"Infinity"===e?"+\u221e":"".concat(e," days"),t=i.rate?i.rate===Number.POSITIVE_INFINITY||"Infinity"===i.rate?"+\u221e":"".concat(i.rate,"%"):l.displayRatio,[{id:1,title:Ke.b.CollateralRatio,type:"ratio",value:{upVal:l.displayRatio,downVal:t}},{id:2,title:Ke.b.PrepaidInterestCoverage,type:"coverage",value:{upVal:l.displayCoverage,downVal:e}},{id:3,title:Ke.b.PrepaidInterest,type:"prepaidInterest",value:{upVal:"".concat(T.a.formatTokenAmount(l.prepaidInterest,r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol),downVal:"".concat(T.a.formatTokenAmount(Number(h),r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol)}},{id:4,title:"Daily Paid Interest Reference",type:"dailyPaid",value:{upVal:"".concat(Object(T.b)(r.positionStatus.estimatedDailyDebt,r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol),downVal:"\u2248 ".concat(p.newEstimatedDailyDebt," ").concat(r.mintTokenInfo.settlementCurrency.symbol)}},{id:5,title:"Outstanding Debt",type:"debt",value:{upVal:p.current,downVal:"\u2248 ".concat(p.next)}}]}),[i,a,l.displayRatio,l.displayCoverage,l.prepaidInterest,r.mintTokenInfo.settlementCurrency.symbol,r.mintTokenInfo.settlementCurrency.decimals,r.positionStatus.estimatedDailyDebt,h,p]),O=Object(m.useCallback)((e=>{const t="ratio"===e.type&&g.rate<it.b.ratio||"coverage"===e.type&&g.coverage<it.b.days?"#FF4D00":"#2AA1FF";return["prepaidInterest","dailyPaid","debt"].includes(e.type)?"#2AA1FF":t}),[g.coverage,g.rate]);return Object(m.useEffect)((()=>{let e=0;o.token&&o.tokenType===k.b.SHORT?e=Number(o.amount):a&&(e=Number(a)),c(e)}),[o,c,a]),Object(oe.jsx)(x.a,{sx:{bgcolor:"rgba(222, 241, 255, 1)",borderRadius:1.8,mt:4,p:2,display:"flex",flexDirection:"column",gap:1.2},children:f.map((e=>Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.5)"},children:e.title}),Object(oe.jsxs)(x.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.6)",textAlign:"right"},children:e.value.upVal}),(a||n)&&Object(oe.jsxs)(x.a,{sx:{display:"flex",alignItems:"center",justifyContent:"end",textAlign:"right"},children:[Object(oe.jsx)(ot.a,{sx:{color:"rgba(0,0,0,0.1)",width:12,height:12}}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,color:O(e)},children:e.value.downVal})]})||null]})]},e.id)))})};const st=Object(Xe.e)("div")(lt||(lt=Object(p.a)(["\n  font-family: PingFang SC;\n  font-size: 12px;\n  font-weight: 400;\n  line-height: 16.8px;\n  text-align: right;\n"]))),dt=Object(Xe.e)("div")(rt||(rt=Object(p.a)(["\n  position: absolute;\n  top: 33px;\n"]))),bt=(e,t)=>{if(Number.isNaN(e))return e;const n="".concat(e);return/e/i.test(n)?e.toFixed(t).replace(/\.?0+$/,""):e},ut=()=>{const[e,t]=Object(m.useState)(-1),{clearAllPendingAction:n,pendingActionList:a,deletePendingAction:o}=Object(y.d)(),{setActionInfo:i,setActiveAmount:l,setActionIndex:r}=Object(y.a)(),{currentMintToken:c}=Object(C.c)(),s=()=>{t(-1)};return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(xe.a,{"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:W.tableHeader,children:[Object(oe.jsxs)(ge.a,{sx:W.tableHeadCell,children:[a.length," Pending Actions"]}),Object(oe.jsx)(ge.a,{align:"right",sx:W.tableHeadCell,children:Object(oe.jsx)(M.a,{size:"small",sx:W.clearAll,onClick:()=>{n()},children:"Clear All"})})]})}),Object(oe.jsx)(he.a,{sx:W.tableBody,children:a.map(((n,a)=>Object(oe.jsxs)(ve.a,{sx:W.tableBodyRow,onMouseEnter:()=>(e=>{t(e)})(a),onMouseLeave:s,onClick:()=>{i({token:n.token,tokenType:n.tokenType}),l(n.amount),r(a)},children:[Object(oe.jsxs)(ge.a,{sx:W.tableBodyCell,children:[Object(oe.jsx)(Pe.a,{color:"error",overlap:"circular",badgeContent:n.type===k.a.ADD?Object(oe.jsx)(Te.a,{sx:{width:7,height:7,color:"#000"}}):Object(oe.jsx)(Fe.a,{sx:{width:7,height:7,color:"#000"}}),anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{".MuiBadge-badge":{padding:0,minWidth:10,minHeight:10,height:10,position:"absolute",bottom:"20%",right:"24%",backgroundColor:"rgba(110, 214, 243, 1)",borderWidth:1,borderColor:"rgba(235, 247, 255, 1)",borderStyle:"solid"}},children:Ye[n.token]()}),Object(oe.jsxs)(ke.a,{sx:{fontWeight:600,marginLeft:"5px"},children:[n.tokenType," ",n.token]})]}),Object(oe.jsx)(ge.a,{align:"right",sx:{p:0,height:66},children:Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"end"},children:[Object(oe.jsxs)(x.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:n.amount}),Object(oe.jsxs)(ke.a,{sx:{fontSize:12,color:"rgba(0, 0, 0, 0.5)"},children:[n.price," ",c]})]}),Object(oe.jsx)(x.a,{sx:{transition:"all 0.3s",width:e===a?32:0,display:"flex",alignItems:"center"},children:Object(oe.jsx)(Ie.a,{onClick:e=>{e.stopPropagation(),o(n.token,n.tokenType)},sx:{transition:"all 0.3s",opacity:e===a?1:0,color:"rgba(0, 0, 0, 1)"},children:Object(oe.jsx)(De.a,{sx:{width:16,height:16}})})})]})})]},n.tokenType+n.token)))})]})})};var jt=()=>{var e,t,n;const[a,o]=Object(m.useState)(null),[i,l]=Object(m.useState)(null!==(e=localStorage.getItem("slippage"))&&void 0!==e?e:"0.5"),[r,c]=Object(m.useState)(10),[s,d]=Object(m.useState)(!1),{chainId:b}=Object(v.b)(),{mintSellHelpContract:u,signer:j,tokenPools:p}=Object(Le.a)(),{walletTokenBalance:h}=Object(Se.a)(),{toastError:g,toastSuccess:f,toastInfo:O}=Object(Ze.a)(),{pendingActionList:I,shortAmount:A}=Object(y.d)(),{activeInfo:S,setActiveAmount:N,clearActive:z}=Object(y.a)(),{onApprove:P,approveStatus:F,checkApproveLoading:R}=Object(y.b)(),{addPendingAction:D,updatePendingAction:V,clearAllPendingAction:L,pendingTokenTypes:B}=Object(y.d)(),{rateInfo:H,onChangeCollateralIndex:U}=Object(y.c)(),{currentPosition:W,collateralIndex:Y,currentMintToken:Z}=Object(C.c)(),{newPrepaidInterestCoverage:X,newCollateralRatio:q,onUpdateCollateralValue:G,onUpdateNeutralizeValue:J}=Object(C.a)(),{handleUpdatePosition:K}=Object(C.b)(),$=Object(m.useCallback)((()=>I.filter((e=>e.tokenType!==k.b.SHORT&&e.tokenType!==k.b.NEUTRALIZE)).map((e=>Ge.e[b].tokens[Ge.h[e.token]].address))),[b,I]),Q=Object(m.useCallback)((()=>I.filter((e=>e.tokenType!==k.b.SHORT&&e.tokenType!==k.b.NEUTRALIZE)).map((e=>Object(T.c)(e.amount.toString(),Ge.e[b].tokens[Ge.h[e.token]].decimals)))),[b,I]);Object(m.useEffect)((()=>{let e=0,t=0;I.forEach((n=>{if(n.tokenType===k.b.SUPPLY)if(W.mintTokenInfo.settlementCurrency.symbol===n.token){const t=n.amount;e+=t}else{const t=Object(qe.b)(b,n.token,W.mintTokenInfo.settlementCurrency.symbol,Object(T.c)(String(n.amount),Ge.e[b].tokens[Ge.h[n.token]].decimals),p);e+=Number(Object(T.b)(t,W.mintTokenInfo.settlementCurrency.decimals))}else n.tokenType===k.b.SHORT&&(t=Number(n.amount))})),G({symbol:W.mintTokenInfo.settlementCurrency.symbol,value:e}),J(t)}),[b,W.mintTokenInfo.settlementCurrency.decimals,W.mintTokenInfo.settlementCurrency.symbol,G,J,I,p]);const ee=Object(m.useMemo)((()=>Boolean(a)),[a]),te=Object(m.useMemo)((async()=>{if(u&&u.previewPositionInfoAfterShort){if(!A)return U({ratio:Number(T.a.formatTokenAmount(q,2)),coverage:Number(T.a.formatTokenAmount(X,0))}),{targetCollateralRatio:Y.collateralRatio};const e=await u.previewPositionInfoAfterShort(W.positionAddress,Object(T.c)(A.toString(),W.mintTokenInfo.decimals),$(),Q());return U({ratio:e.targetCollateralRatio.toNumber()/100,coverage:Number(T.a.formatTokenAmount(X,0))}),e}return{targetCollateralRatio:0}}),[u,A,W.positionAddress,W.mintTokenInfo.decimals,$,Q,U,X,q,Y.collateralRatio]),ne=Object(m.useCallback)((async()=>{const e=await te,t=new He.utils.Interface(Be.a.actionMintSell.abi),{decimals:n}=W.mintTokenInfo,a=t.encodeFunctionData("short",[Object(T.c)(A.toString(),n),Object(T.c)(T.a.formatTokenAmount(A-A*(i/100),n),n),$(),Q(),e.targetCollateralRatio,Number((Date.now()/1e3).toFixed())+60*r]);try{const e=new Ue.ethers.Contract(W.positionAddress,Je,j),t=await e.delegateCall(Be.a.actionMintSell.address[b],a);try{if(void 0!==t&&t.hash){O(Ke.e.submited,Object(oe.jsx)($e.a,{content:"Waiting for confirmation",txHash:t.hash}));0!==(await t.wait()).confirmations&&(f(Ke.e.success,Object(oe.jsx)($e.a,{content:"The transaction has been successfully",txHash:t.hash})),z(),L(),await K())}}catch(o){g(Ke.e.failed,o.reason)}}catch(o){g(Ke.e.failed,o.reason)}}),[Q,$,b,z,L,te,W.mintTokenInfo,W.positionAddress,r,K,i,A,j,g,O,f]),ae=Object(m.useMemo)((()=>{const e=h&&h[S.token],t=S.amount&&S.amount>e,n=Number(S.amount)<=0;if(S.token){const e=Number(S.amount)*10**Ge.e[b].tokens[Ge.h[S.token]].decimals;if(S.amount&&e>Number.MAX_SAFE_INTEGER)return!0}return S.tokenType!==k.b.SHORT&&t||n}),[S.amount,S.token,S.tokenType,b,h]),ie=Object(m.useMemo)((()=>{let{coverage:e}=H;return A&&(H.rate<120?e="N/A":H.rate>=120&&e<20&&(e=20)),!(H.rate>=120&&e>=20)}),[H,A]),le=Object(m.useMemo)((()=>-1!==S.activeIndex),[S]),[re,ce]=Object(m.useState)(!1),se=Object(m.useCallback)((async()=>{if(ae)return;const e={token:S.token,tokenType:S.tokenType,amount:Number(S.amount),price:S.amount};if(Z!==S.token){const t=Ge.e[b].tokens[Ge.h[S.token]].decimals,n=_e.a.from(T.a.formatTokenAmount(S.amount*10**t,0)),a=Object(qe.b)(b,S.token,Z,n,p);e.price=T.a.formatFourDecimals(Number(Object(T.b)(a,W.mintTokenInfo.decimals)))}if(F)le?(V(e),z()):(D(e),z());else{d(!0);try{const t=await P();O(Ke.e.submited,Object(oe.jsx)($e.a,{content:"The approve has been submitted",txHash:t.hash}));const n=await t.wait();1===n.status&&(V(e),z(),d(!1),f(Ke.e.success,Object(oe.jsx)($e.b,{txHash:n.transactionHash,content:"The approve has been successfully"})))}catch(t){d(!1)}}}),[S.amount,S.token,S.tokenType,D,F,b,z,Z,W.mintTokenInfo.decimals,ae,le,P,O,f,p,V]);return Object(oe.jsxs)(x.a,{sx:{width:"100%"},children:[Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:16,fontWeight:500},children:null!==S&&void 0!==S&&S.token?"".concat(S.tokenType," ").concat(S.token):"".concat(Z," Wallet Balance")}),Object(oe.jsx)(Ie.a,{"aria-controls":ee?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":ee?"true":void 0,onClick:e=>{o(e.currentTarget)},sx:{p:0,width:24,height:24},children:Object(oe.jsx)(w.t,{})}),Object(oe.jsx)(nt,{handleClose:()=>{o(null)},anchorEl:a,maxSlippageValue:i,open:ee,deadline:r,setMaxSlippageValue:e=>{localStorage.setItem("slippage",e),l(e)},setDeadlineValue:e=>c(e)})]}),Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.6},children:[Object(oe.jsxs)(x.a,{sx:{display:"flex",alignItems:"center",gap:1.2,width:"100%",height:"45px",transition:"300ms all"},children:[null!==S&&void 0!==S&&S.token?Ye[null===S||void 0===S?void 0:S.token]({style:{width:42,height:42}}):Object(oe.jsx)(w.j,{style:{width:42,height:42}}),Object(oe.jsxs)("div",{style:{width:"100%",position:"relative"},children:[Object(oe.jsx)(_,{children:Object(oe.jsx)("input",{readOnly:!(null!==S&&void 0!==S&&S.token),type:"number",placeholder:null!==S&&void 0!==S&&S.token?0:h[Z],value:null!==S&&void 0!==S&&S.amount.toString()?bt(null===S||void 0===S?void 0:S.amount,Ve.b[S.token].decimals):"",onFocus:()=>ce(!0),onBlur:()=>{(""===(null===S||void 0===S?void 0:S.amount.toString())||(null===S||void 0===S?void 0:S.amount)<0)&&ce(!1)},onChange:e=>{let t="";const n=e.target.value.replace(/[^\d.]/g,"");if(n.includes(".")){var a;const e=n.split(".");e[1]=null===(a=e[1])||void 0===a?void 0:a.slice(0,Ge.e[b].tokens[Ge.h[S.token]].decimals),t=e.join(".")}else t=n;N(t||"")}})}),null!==S&&void 0!==S&&S.token&&re&&"Short"!==S.tokenType?Object(oe.jsx)(dt,{children:Object(oe.jsx)(x.a,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",color:"rgba(0,0,0,.5)",paddingLeft:"4px"},children:Object(oe.jsxs)(st,{children:[h[null!==(t=null===S||void 0===S?void 0:S.token)&&void 0!==t?t:Z]," Available"]})})}):Object(oe.jsx)(oe.Fragment,{})]})]}),(null===S||void 0===S?void 0:S.token)&&S.tokenType!==k.b.SHORT&&Object(oe.jsx)(x.a,{children:Object(oe.jsx)(M.a,{size:"small",sx:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"},onClick:()=>(()=>{var e;"Short"!==S.tokenType&&N(h[null!==(e=null===S||void 0===S?void 0:S.token)&&void 0!==e?e:Z])})(),children:"Max"})})]}),(null===S||void 0===S?void 0:S.token)&&Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:3,mt:3},children:[Object(oe.jsx)(E,{variant:"contained",disableElevation:!0,onClick:()=>{z()},children:"Cancel"}),R?Object(oe.jsx)(E,{disabled:!0,variant:"contained",disableElevation:!0,children:"Check Approving"}):Object(oe.jsx)(E,{disabled:ae||s,variant:"contained",disableElevation:!0,onClick:se,children:F?"".concat(le?"Update":"Add"," Action"):"Approve & Add"})]}),I.length>0&&Object(oe.jsx)(x.a,{children:Object(oe.jsx)(ut,{})}),(null===(n=B.get(Z))||void 0===n?void 0:n.includes(k.b.SHORT))&&Object(oe.jsx)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:Object(oe.jsx)(E,{onClick:()=>ne(),variant:"contained",disableElevation:!0,disabled:ie,children:"Submit Transaction"})}),Object(oe.jsx)(ct,{})]})};var pt=function(){return Object(oe.jsxs)("div",{style:B,children:[Object(oe.jsx)(H,{children:Object(oe.jsx)(Me,{})}),Object(oe.jsx)(U,{children:Object(oe.jsx)(jt,{})})]})},mt=n.p+"static/media/neutralize.1c2056a6.svg";var xt,ht,gt=e=>{let{neutralizeType:t}=e;const{walletTokenBalance:n}=Object(Se.a)(),{neutralizeAmount:a}=Object(y.d)(),{activeInfo:o}=Object(y.a)(),{activeTab:i}=Object(y.c)(),{collateralIndex:l,currentPosition:r,currentPositionTokenInfo:c}=Object(C.c)(),{newEstimatedDailyDebt:s,newOutStandingDebt:d,newNeutralizeFee:b,newPrepaidInterestCoverage:u,newDisplayPrepaidInterestCoverage:j,newDisplayCollateralRatio:p,newCollateralRatio:h,onUpdateNeutralizeValue:g}=Object(C.a)(),f=Object(m.useMemo)((()=>{if(c.allowedTokens){const{balances:e,tokens:t}=c.allowedTokens;return Object.keys(e).reduce(((n,a)=>({...n,[a]:Object(T.b)(e[a],t[a].decimals,!0)})),{})}return Object.keys(Ge.h).reduce(((e,t)=>({...e,[t]:0})),{})}),[c.allowedTokens]),O=Object(m.useMemo)((()=>[{id:1,title:"Collateral Ratio",type:"ratio",value:{upVal:l.displayRatio,downVal:p}},{id:2,title:"Prepaid Interest Coverage",type:"coverage",value:{upVal:l.displayCoverage,downVal:u>0||u!==Number.POSITIVE_INFINITY?"\u2248 ".concat(j):j}},{id:3,title:"Prepaid Interest",type:"prepaidInterest",value:{upVal:"".concat(T.a.formatTokenAmount(l.prepaidInterest,r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol),downVal:"".concat(T.a.formatTokenAmount(l.prepaidInterest,r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol)}},{id:4,title:"Daily Paid Interest Reference",type:"dailyPaid",value:{upVal:"".concat(l.estimatedDailyDebt," WBTC"),downVal:"".concat(Object(T.b)(Number(T.a.formatTokenAmount(s,0)),r.mintTokenInfo.settlementCurrency.decimals)," ").concat(r.mintTokenInfo.settlementCurrency.symbol)}},{id:5,title:"Outstanding Debt",type:"debt",value:{upVal:Object(T.b)(r.balance,r.mintTokenInfo.decimals),downVal:Object(T.b)(d,r.mintTokenInfo.decimals)}},{id:6,title:"Estimate Neutralize Fee",type:"neutralizeFee",value:{upVal:"0 ".concat(r.mintTokenInfo.settlementCurrency.symbol),downVal:"\u2248 ".concat(b," ").concat(r.mintTokenInfo.settlementCurrency.symbol)}}]),[l.displayRatio,l.displayCoverage,l.prepaidInterest,l.estimatedDailyDebt,p,u,j,r.mintTokenInfo.settlementCurrency.symbol,r.mintTokenInfo.settlementCurrency.decimals,r.mintTokenInfo.decimals,r.balance,s,d,b]),v=Object(m.useCallback)((e=>{const a="wallet"===t&&n&&b>n[r.mintTokenInfo.settlementCurrency.symbol],o="avatar"===t&&f&&b>f[r.mintTokenInfo.settlementCurrency.symbol],i="ratio"===e.type&&h<it.b.ratio&&a||"ratio"===e.type&&h<it.b.ratio&&o||"coverage"===e.type&&u<it.b.days&&o||"coverage"===e.type&&u<it.b.days&&a?"#FF4D00":"#2AA1FF";return["prepaidInterest","dailyPaid","debt"].includes(e.type)?"#2AA1FF":i}),[f,r.mintTokenInfo.settlementCurrency.symbol,t,h,b,u,n]);return Object(m.useEffect)((()=>{if((null===o||void 0===o?void 0:o.tokenType)===k.b.NEUTRALIZE){const e=Number(null===o||void 0===o?void 0:o.amount)||0;g(e?Number("-".concat(e)):0)}else if(2===i){const e=Number(a)||0;g(e?Number("-".concat(e)):0)}}),[o,g,a,i]),Object(oe.jsx)(x.a,{sx:{bgcolor:"rgba(222, 241, 255, 1)",borderRadius:1.8,mt:4,p:2,display:"flex",flexDirection:"column",gap:1.2},children:O.map((e=>Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",textAlign:"right"},children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.5)",textAlign:"right"},children:e.title}),Object(oe.jsxs)(x.a,{children:[Object(oe.jsx)(ke.a,{sx:{fontSize:12,color:"rgba(0,0,0,0.6)",textAlign:"right"},children:e.value.upVal}),Object(oe.jsxs)(x.a,{sx:{display:"flex",alignItems:"center",textAlign:"right",justifyContent:"end"},children:[Object(oe.jsx)(ot.a,{sx:{color:"rgba(0,0,0,0.1)",width:12,height:12}}),Object(oe.jsx)(ke.a,{sx:{fontSize:10,color:v(e),textAlign:"right"},children:e.value.downVal})]})||null]})]},e.id)))})};function ft(){return Object(oe.jsx)("div",{children:Object(oe.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(oe.jsx)("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:"#FF2E00"}),Object(oe.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.57852 10.156C8.82398 10.156 9.02296 10.355 9.02296 10.6004V11.756C9.02296 12.0015 8.82398 12.2004 8.57852 12.2004H7.42296C7.1775 12.2004 6.97852 12.0015 6.97852 11.756V10.6004C6.97852 10.355 7.1775 10.156 7.42296 10.156H8.57852ZM8.57852 3.62842C8.82398 3.62842 9.02296 3.8274 9.02296 4.07286V8.74859C9.02296 8.99405 8.82398 9.19303 8.57852 9.19303H7.42296C7.1775 9.19303 6.97852 8.99405 6.97852 8.74859V4.07286C6.97852 3.8274 7.1775 3.62842 7.42296 3.62842H8.57852Z",fill:"white"})]})})}function Ot(){return Object(oe.jsx)("div",{children:Object(oe.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(oe.jsx)("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:"#73797C"}),Object(oe.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.42295 5.6736C7.17749 5.6736 6.9785 5.47461 6.9785 5.22915V4.0736C6.9785 3.82814 7.17749 3.62915 7.42295 3.62915H8.5785C8.82396 3.62915 9.02295 3.82814 9.02295 4.0736L9.02295 5.22915C9.02295 5.47461 8.82396 5.6736 8.5785 5.6736H7.42295ZM7.42295 12.2012C7.17749 12.2012 6.9785 12.0022 6.9785 11.7567V7.081C6.9785 6.83554 7.17749 6.63656 7.42295 6.63656H8.5785C8.82396 6.63656 9.02295 6.83554 9.02295 7.081V11.7567C9.02295 12.0022 8.82396 12.2012 8.5785 12.2012H7.42295Z",fill:"white"})]})})}const vt=Object(Xe.e)("div")(xt||(xt=Object(p.a)(["\n  font-family: PingFang SC;\n  font-size: 12px;\n  font-weight: 400;\n  line-height: 16.8px;\n  text-align: right;\n"]))),yt=Object(Xe.e)("div")(ht||(ht=Object(p.a)(["\n  position: absolute;\n  top: 33px;\n"]))),kt=e=>{let{setNeutralizeType:t}=e;const[n,a]=Object(m.useState)(-1),{setActionInfo:o,setActiveAmount:i,setActionIndex:l}=Object(y.a)(),{pendingActionList:r,clearAllPendingAction:c,deleteNeutralizePendingAction:s}=Object(y.d)(),d=()=>{a(-1)};return Object(oe.jsx)(fe.a,{component:ye.a,sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:Object(oe.jsxs)(xe.a,{"aria-label":"simple table",children:[Object(oe.jsx)(Oe.a,{children:Object(oe.jsxs)(ve.a,{sx:W.tableHeader,children:[Object(oe.jsxs)(ge.a,{sx:W.tableHeadCell,children:[r.length," Pending Actions"]}),Object(oe.jsx)(ge.a,{align:"right",sx:W.tableHeadCell,children:Object(oe.jsx)(M.a,{size:"small",sx:W.clearAll,onClick:()=>{c()},children:"Clear All"})})]})}),Object(oe.jsx)(he.a,{sx:W.tableBody,children:r.map(((e,r)=>Object(oe.jsxs)(ve.a,{sx:W.tableBodyRow,onMouseEnter:()=>(e=>{a(e)})(r),onMouseLeave:d,onClick:()=>{o({token:e.token,tokenType:e.tokenType}),i(e.amount),l(r),t(e.neutralizeType)},children:[Object(oe.jsxs)(ge.a,{sx:W.tableBodyCell,children:[Object(oe.jsx)(Pe.a,{color:"error",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{".MuiBadge-badge":{padding:0,minWidth:10,minHeight:10,height:10,position:"absolute",bottom:"20%",right:"24%",backgroundColor:"rgba(110, 214, 243, 1)",borderWidth:1,borderColor:"rgba(235, 247, 255, 1)",borderStyle:"solid"}},children:Ye[e.neutralizeType]()}),Object(oe.jsxs)(ke.a,{sx:{fontWeight:600,marginLeft:"5px"},children:[e.tokenType," ",e.token]})]}),Object(oe.jsx)(ge.a,{align:"right",sx:{p:0,height:66},children:Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"end",alignItems:"center"},children:[Object(oe.jsx)(x.a,{children:Object(oe.jsx)(ke.a,{sx:{fontSize:14},children:e.amount})}),Object(oe.jsx)(x.a,{sx:{transition:"all 0.3s",width:n===r?32:0,display:"flex",alignItems:"center"},children:Object(oe.jsx)(Ie.a,{onClick:t=>{t.stopPropagation(),s(e.token,e.neutralizeType)},sx:{transition:"all 0.3s",opacity:n===r?1:0,color:"rgba(0, 0, 0, 1)"},children:Object(oe.jsx)(De.a,{sx:{width:16,height:16}})})})]})})]},e.tokenType+e.token)))})]})})},{ActionUser:It}=Be.a,wt=new He.utils.Interface(It.abi);var Tt,Ct,At,St,Nt=function(){var e;const{chainId:t}=Object(v.b)(),{walletTokenBalance:n,setRefresh:a}=Object(Se.a)(),[o,i]=Object(m.useState)("wallet"),{addPendingAction:l,updateNeutralizePendingAction:r,deleteNeutralizePendingAction:c,clearAllPendingAction:s,pendingActionList:d}=Object(y.d)(),{signer:b}=Object(Le.a)(),{toastSuccess:u,toastError:j,toastInfo:p}=Object(Ze.a)(),[h,g]=Object(m.useState)(!1),[f,O]=Object(m.useState)(!1),{activeInfo:I,setActiveAmount:A,setActiveTab:S,clearActive:N}=Object(y.a)(),{onApprove:z,checkApproveLoading:P,approveStatus:F}=Object(y.b)(),R=Object(m.useMemo)((()=>-1!==I.activeIndex),[I.activeIndex]),[D,V]=Object(m.useState)(!1),[,L]=Object(m.useState)(!0),{currentPositionTokenInfo:B,currentMintToken:H,currentPosition:U}=Object(C.c)(),{handleUpdatePosition:W}=Object(C.b)(),{newNeutralizeFee:Y}=Object(C.a)(),Z=Object(m.useMemo)((()=>{if(B.allowedTokens){const{balances:e,tokens:t}=B.allowedTokens;return Object.keys(e).reduce(((n,a)=>({...n,[a]:Object(T.b)(e[a],t[a].decimals,!0)})),{})}return Object.keys(Ge.h).reduce(((e,t)=>({...e,[t]:0})),{})}),[B.allowedTokens]),G=Object(m.useMemo)((()=>Number(Object(T.b)(U.balance,U.mintTokenInfo.decimals))),[U.balance,U.mintTokenInfo.decimals]),J=Object(m.useMemo)((()=>{const{amount:e}=I;return e<=0||e>0&&("wallet"===o?e>n[I.token]||e>G:e>Z[I.token]||e>G)}),[I,Z,G,o,n]),K=Object(m.useMemo)((()=>0===d.length),[d]),$=Object(m.useMemo)((()=>d.some((e=>!(!e||!e.neutralizeType)&&e.neutralizeType===o))),[o,d]),Q=Object(m.useCallback)((async()=>{d.forEach((async e=>{if(e.tokenType===k.b.NEUTRALIZE){V(!0);const o=wt.encodeFunctionData("neutralizetBalance",[Object(T.c)(e.amount.toString(),U.mintTokenInfo.decimals)||"0","wallet"===e.neutralizeType]);try{const e=new Ue.ethers.Contract(U.positionAddress,Je,b),n=await e.delegateCall(It.address[t],o);if(n){p(Ke.e.submited,Object(oe.jsx)($e.a,{content:"Waiting for confirmation",txHash:n.hash}));await n.wait()&&(a((e=>!e)),u(Ke.e.success,Object(oe.jsx)($e.a,{content:"The transaction has been successfully",txHash:n.hash})),s(),A(""),V(!1),await W())}}catch(n){V(!1),j(Ke.e.failed,null===n||void 0===n?void 0:n.reason)}}}))}),[d,U.mintTokenInfo.decimals,U.positionAddress,b,t,p,a,u,s,A,W,j]),ee=Object(m.useCallback)((()=>"wallet"===o?n&&Y>n[U.mintTokenInfo.settlementCurrency.symbol]:"avatar"===o&&(Z&&Y>Z[U.mintTokenInfo.settlementCurrency.symbol])),[Z,U.mintTokenInfo.settlementCurrency.symbol,o,Y,n]),te=Object(m.useCallback)((e=>"wallet"===o&&"wallet"===e?n&&I.amount>n[H]?"red":"":"avatar"===o&&"avatar"===e&&Z&&I.amount>Z[H]?"red":""),[o,n,I.amount,H,Z]),ne=Object(m.useCallback)((e=>{const{settlementCurrency:t}=U.mintTokenInfo;return o===e?n&&Y>n[t.symbol]?"red":"":o===e&&Z&&Y>Z[t.symbol]?"red":""}),[Z,U.mintTokenInfo,o,Y,n]);return Object(oe.jsxs)(x.a,{sx:{width:"100%"},children:[Object(oe.jsx)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:Object(oe.jsxs)(ke.a,{sx:{fontSize:16,fontWeight:500},children:["Neutralize ",H]})}),Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.6},children:[Object(oe.jsx)(x.a,{sx:{height:"45px",transition:"300ms all",width:"100%"},children:Object(oe.jsxs)(x.a,{sx:{display:"flex",alignItems:"center",gap:1.2,width:"100%"},children:[Object(oe.jsx)(w.j,{style:{width:42,height:42}}),Object(oe.jsxs)("div",{style:{width:"100%",position:"relative"},children:[Object(oe.jsx)(_,{children:Object(oe.jsx)("input",{type:"number",placeholder:"0",value:null!==(e=null===I||void 0===I?void 0:I.amount)&&void 0!==e?e:"",onBlur:()=>{(""===(null===I||void 0===I?void 0:I.amount.toString())||(null===I||void 0===I?void 0:I.amount)<0)&&g(!1)},onFocus:()=>g(!0),onChange:e=>{let t="";const n=e.target.value.replace(/[^\d.]/g,"");if(n.includes(".")){var a;const e=n.split(".");e[1]=null===(a=e[1])||void 0===a?void 0:a.slice(0,U.mintTokenInfo.decimals),t=e.join(".")}else t=n;A(t||"")}})}),null!==I&&void 0!==I&&I.token&&h?Object(oe.jsx)(yt,{children:Object(oe.jsx)(x.a,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",color:"rgba(0,0,0,.5)",paddingLeft:"4px",position:"relative"},children:Object(oe.jsxs)(vt,{children:["wallet"===o?n[null===I||void 0===I?void 0:I.token]:Z[null===I||void 0===I?void 0:I.token]," ","Available"]})})}):Object(oe.jsx)(oe.Fragment,{})]})]})}),Object(oe.jsx)(x.a,{children:Object(oe.jsx)(M.a,{size:"small",sx:{textTransform:"none",borderRadius:1.8,color:"rgba(110, 214, 243, 1)"},onClick:()=>(()=>{if("avatar"===o)if(Z&&Z[H]){let e=Z[H];Z[H]>G&&(e=G),A(e),L(!(e>0))}else L(!0);if("wallet"===o){let e=n[H];n[H]>G&&(e=G),A(e),L(!(e>0))}})(),children:"Max"})})]}),Object(oe.jsxs)(q,{children:[Object(oe.jsx)("p",{className:"title-neutralize",children:"Neutralize the asset from"}),Object(oe.jsxs)("div",{className:"content",children:[Object(oe.jsx)("div",{className:"item_wrap ".concat("wallet"===o?"active":""),onClick:()=>{i("wallet");const e=d.find((e=>"avatar"===e.neutralizeType));console.log("neutralize",e),e?c(e.token,e.neutralizeType):(I.amount>0&&R||$)&&l({currentMintToken:H,tokenType:k.b.NEUTRALIZE,amount:Number(I.amount),neutralizeType:"wallet",price:1})},onKeyUp:()=>null,tabIndex:0,role:"button",children:Object(oe.jsxs)("div",{className:"item wallet",children:[Object(oe.jsxs)("h4",{children:[Object(oe.jsx)(We.a,{})," My Wallet"]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:H}),Object(oe.jsx)("span",{style:{color:te("wallet")},children:n&&T.a.formatFourDecimals(n[H])||0})]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:U.mintTokenInfo.settlementCurrency.symbol}),Object(oe.jsx)("span",{style:{color:ne("wallet")},children:n&&T.a.formatFourDecimals(n[U.mintTokenInfo.settlementCurrency.symbol])||0})]})]})}),Object(oe.jsx)("div",{className:"item_wrap ".concat("avatar"===o?"active":""),onClick:()=>{i("avatar");const e=d.find((e=>"wallet"===e.neutralizeType));console.log("neutralize",e),e?c(e.token,e.neutralizeType):(I.amount>0&&R||$)&&l({token:H,tokenType:k.b.NEUTRALIZE,amount:Number(I.amount),neutralizeType:"avatar",price:1})},onKeyUp:()=>null,tabIndex:0,role:"button",children:Object(oe.jsxs)("div",{className:"item avatar",children:[Object(oe.jsxs)("h4",{children:[Object(oe.jsx)(w.b,{}),"Collateral"]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:H}),Object(oe.jsx)("span",{style:{color:te("avatar")},children:Z&&T.a.formatFourDecimals(Z[H])||0})]}),Object(oe.jsxs)("p",{children:[Object(oe.jsx)("span",{children:U.mintTokenInfo.settlementCurrency.symbol}),Object(oe.jsx)("span",{style:{color:ne("wallet")},children:Z&&T.a.formatFourDecimals(Z[U.mintTokenInfo.settlementCurrency.symbol])||0})]})]})})]})]}),Object(oe.jsxs)(X,{children:[ee()?Object(oe.jsx)(ft,{}):Object(oe.jsx)(Ot,{}),Object(oe.jsx)("p",{style:{color:ee()?"red":""},children:"A 1.0% fee of the token value will be levied after the position is neutralized."})]}),Object(oe.jsxs)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:3,mt:1.6},children:[Object(oe.jsx)(E,{variant:"contained",disableElevation:!0,disabled:D,onClick:()=>{s(),N(),S(1)},children:"Cancel"}),P?Object(oe.jsx)(E,{disabled:!0,variant:"contained",disableElevation:!0,children:"Check Approving"}):Object(oe.jsx)(E,{variant:"contained",disableElevation:!0,disabled:J||f||D,onClick:async()=>{const e={token:H,tokenType:k.b.NEUTRALIZE,amount:Number(I.amount),neutralizeType:o,price:1};if(F)R||$?r(e):I.amount>0&&l(e);else{O(!0);try{const t=await z();p("Approve Submitted");1===(await t.wait()).status&&(l(e),N(),O(!1),u("Approved Successfully"))}catch(t){O(!1)}}},children:F?"".concat(R||$?"Update":"Add"," Action"):"Approve & Add"})]}),d.length>0&&Object(oe.jsx)(x.a,{children:Object(oe.jsx)(kt,{setNeutralizeType:e=>{i(e)}})}),d.length>0&&Object(oe.jsx)(x.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:Object(oe.jsx)(E,{onClick:()=>{Q()},disabled:K||D,variant:"contained",disableElevation:!0,children:"Submit Transaction"})}),Object(oe.jsx)(gt,{neutralizeType:o})]})};const zt=Object(Xe.e)("div")(Tt||(Tt=Object(p.a)(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 539px;\n  margin: auto;\n\n  img {\n    width: 539px;\n    height: 368.98px;\n  }\n\n  .nutralize_action {\n    position: absolute;\n    display: flex;\n    width: 100px;\n    top: 0;\n    right: 43px;\n  }\n\n  .collateral_action {\n    bottom: 0;\n    left: 0;\n    position: absolute;\n    display: flex;\n\n    p {\n      flex-direction: column;\n    }\n  }\n"]))),Mt=Object(Xe.e)("span")(Ct||(Ct=Object(p.a)(["\n  font-family: PingFangSC-Medium, sans-serif;\n  display: block;\n  width: 25px;\n  height: 25px;\n  border-radius: 50%;\n  text-align: center;\n  line-height: 25px;\n  font-weight: 500;\n  font-size: 20px;\n  border: 1px solid #000000;\n  color: #000000;\n  margin-right: 13px;\n  flex: none;\n"]))),Pt=Object(Xe.e)("p")(At||(At=Object(p.a)(["\n  span {\n    font-family: PingFangSC-Medium, sans-serif;\n    font-weight: 500;\n    font-size: 16px;\n    line-height: 22px;\n    color: #000000;\n    white-space: nowrap;\n  }\n\n  display: flex;\n  flex-wrap: wrap;\n"]))),Et=Object(Xe.e)(w.c)(St||(St=Object(p.a)(["\n  box-shadow: none !important;\n  background: linear-gradient(90deg, #61c2f7 0%, #7ae9f0 100%) !important;\n  color: #000 !important;\n  border-radius: 20px !important;\n  height: 24px !important;\n  line-height: 24px !important;\n  font-family: PingFangSC-Medium, sans-serif !important;\n  font-weight: 500 !important;\n  font-size: 12px !important;\n  letter-spacing: 0.02em !important;\n  margin-top: 13px !important;\n  white-space: nowrap !important;\n"])));var Ft,Rt,Dt=function(){return Object(oe.jsx)(oe.Fragment,{children:Object(oe.jsxs)("div",{style:B,children:[Object(oe.jsx)(H,{children:Object(oe.jsxs)(zt,{children:[Object(oe.jsx)("img",{src:mt,alt:""}),Object(oe.jsxs)("div",{className:"action nutralize_action",children:[Object(oe.jsx)(Mt,{children:"1"})," ",Object(oe.jsx)(Pt,{children:Object(oe.jsx)("span",{children:"Neutralize"})})]}),Object(oe.jsxs)("div",{className:"action collateral_action",children:[Object(oe.jsx)(Mt,{children:"2"})," ",Object(oe.jsxs)(Pt,{children:[Object(oe.jsxs)("span",{children:["Get back the ",Object(oe.jsx)("br",{})," collateral to wallet"]}),Object(oe.jsx)(h.b,{to:"/collateral/manage",children:Object(oe.jsx)(Et,{children:"Collateral Management"})})]})]})]})}),Object(oe.jsx)(U,{children:Object(oe.jsx)(Nt,{})})]})})};const Vt=Object(g.a)("div")(Ft||(Ft=Object(p.a)(["\n  padding-right: 40px;\n  height: 80vh;\n  overflow: scroll;\n  min-width: 1200px;\n  padding-bottom: 30px;\n"]))),Lt=Object(g.a)("div")(Rt||(Rt=Object(p.a)(["\n  font-size: 14px;\n"])));function Bt(){const{chainId:e}=Object(v.b)(),{clearAllPendingAction:t}=Object(y.d)(),{pendingActionList:n}=Object(y.d)(),{setActionInfo:a,setActiveAmount:o,setActiveTab:i,clearActive:l,activeInfo:r}=Object(y.a)(),c=Object(I.c)((e=>e.short.activeTab)),s=Object(m.useMemo)((()=>{const e=n.filter((e=>e.tokenType===k.b.SHORT));return e.length&&e[0].amount||""}),[n]),[d,b]=Object(m.useState)(c),{onChangeCollateralIndex:u}=Object(y.c)(),{currentMintToken:j,currentPosition:p,collateralIndex:g}=Object(C.c)(),{handleChangeCurrentPosition:z}=Object(C.b)(),M=Object(m.useMemo)((()=>{if(Object(A.f)(e)){const t=S.c[e].tokens;return Object.keys(S.c[e].tokens).map((e=>({token:t[e].symbol,address:t[e].address,decimals:t[e].decimals,icon:()=>Object(oe.jsx)(N.a,{imgprops:{style:{marginRight:10}},token:t[e].logo,symbol:t[e].symbol})})))}return[]}),[e]);return Object(m.useEffect)((()=>{b(c)}),[c]),Object(m.useEffect)((()=>{u({ratio:Number(T.a.formatTokenAmount(g.collateralRatio,2)),coverage:Number(T.a.formatTokenAmount(g.prepaidInterestCoverage,0))})}),[g,u]),Object(oe.jsxs)(x.a,{sx:Y.box,children:[Object(oe.jsx)(f.f,{children:"Short & Neutralize"}),Object(oe.jsxs)(Vt,{children:[Object(oe.jsxs)(x.a,{sx:Y.topBox,children:[Object(oe.jsx)(O.a,{selectValue:j,options:M,isGroup:!1,onChange:e=>{z(e),t(),o(""),l(),a({token:e,tokenType:1===d?k.b.SHORT:k.b.NEUTRALIZE})}}),p.isEnable&&Object(oe.jsxs)(x.a,{sx:{display:"flex",gap:"12px"},children:[1===d&&Object(oe.jsxs)(E,{variant:"contained",disableElevation:!0,onClick:()=>{console.log("activeInfo :>> ",r),l(),a({token:j,tokenType:k.b.SHORT}),o(Number(s)||""),1!==c&&t(),b(1),i(1)},children:["Short ",s&&T.a.formatFourDecimals(Number(s))]}),Number(s)<=0&&Object(oe.jsx)(E,{variant:"contained",disableElevation:!0,onClick:()=>{t(),i(2),b(2),a({token:j,tokenType:k.b.NEUTRALIZE})},children:"Neutralize"})]})]}),!p.isEnable&&Object(oe.jsxs)(h.b,{to:"/collateral",children:[" ",Object(oe.jsxs)(Lt,{children:["Please enable the collateral of ",p.mintTokenInfo.symbol," first ",Object(oe.jsx)(w.a,{})]})]}),p.isEnable&&Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)(me,{}),1===d&&Object(oe.jsx)(pt,{}),2===d&&Object(oe.jsx)(Dt,{})]})]})]})}t.default=Object(m.memo)(Bt)},442:function(e,t,n){"use strict";var a=n(1),o=n(147);t.a=()=>{const e=Object(a.useContext)(o.a);if(void 0===e)throw new Error("hashPowerToken context undefined");return e}},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(1);var a=n(0);function o(e){var t;return Object(a.jsx)("img",{...e.imgprops,style:{width:22,height:22,...null===(t=e.imgprops)||void 0===t?void 0:t.style},src:e.token,alt:e.symbol})}},457:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return x}));var a=n(39),o=n(28),i=n(491),l=n(1),r=n(26),c=n(95),s=n(144),d=n(30),b=n(94),u=n(225);function j(){const{account:e,chainId:t}=Object(o.b)(),n=Object(a.c)((e=>e.short.activeInfo)),{currentPosition:u}=Object(s.c)(),{onCheckApprove:j}=Object(i.b)(),{handleApprove:p}=Object(i.a)(e,n.token?r.b[n.token].address[t]:"0"),[m,x]=Object(l.useState)(!1),[h,g]=Object(l.useState)(!1),{toastError:f}=Object(c.a)();Object(l.useEffect)((()=>{n.token&&(g(!0),j(e,d.e[t].tokens[d.h[n.token]].address,u.positionAddress).then((e=>{e&&e._hex>0?x(!0):x(!1)})).catch((()=>{x(!1)})).finally((()=>{g(!1)})))}),[e,n,t,u.positionAddress,j]);return{approveStatus:m,onApprove:Object(l.useCallback)((async()=>{try{x(!0);return await p(u.positionAddress)}catch(e){throw x(!1),f(b.e.failed,"".concat(e.reason)),e}}),[p,u.positionAddress,f]),checkApproveLoading:h}}function p(){const e=Object(a.b)(),{activeAmount:t,activeInfo:n,activeIndex:o}=Object(a.c)((e=>e.short)),{pendingActionList:i}=m(),r=Object(l.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(Object(u.e)({activeInfo:t}));const n=i.findIndex((e=>e.token===t.token&&e.tokenType===t.tokenType));n>=0&&e(Object(u.f)({index:n}))}),[e,i]),c=Object(l.useCallback)((t=>{e(Object(u.h)({index:t}))}),[e]),s=Object(l.useCallback)((t=>{e(Object(u.f)({index:t}))}),[e]),d=Object(l.useCallback)((t=>{e(Object(u.g)({amount:t}))}),[e]),b=Object(l.useCallback)((()=>{r(),d(""),s(-1)}),[s,r,d]),j=Object(l.useMemo)((()=>null!==n&&void 0!==n&&n.token?{...n,amount:t,activeIndex:o}:{token:null,amount:"",tokenType:null,activeIndex:-1,approveStatus:!1}),[t,o,n]),p=Object(l.useCallback)((t=>{let{ratio:n,coverage:a}=t;e(Object(u.i)({rateInfo:{rate:n,coverage:a}}))}),[e]);return{setActionInfo:r,setActiveAmount:d,clearActive:b,setActiveTab:c,activeInfo:j,setActionIndex:s,onChangeCollateralIndex:p}}function m(){const e=Object(a.b)(),{pendingActions:t}=Object(a.c)((e=>e.short)),n=Object(l.useMemo)((()=>new Map(t)),[t]),o=Object(l.useCallback)((t=>{const a=n.get(t.token)||[];n.set(t.token,[...a,{...t,type:u.a.ADD}]),e(Object(u.d)({actions:n}))}),[e,n]),i=Object(l.useCallback)(((t,a)=>{const o=[...n.get(t)||[]].filter((e=>e.tokenType!==a));n.set(t,o),e(Object(u.d)({actions:n}))}),[e,n]),r=Object(l.useCallback)((()=>{e(Object(u.d)({actions:new Map}))}),[e]),c=Object(l.useCallback)((t=>{const a=[...n.get(t.token)||[]],o=a.findIndex((e=>e.tokenType===t.tokenType));a.splice(o,1,{...t,type:u.a.ADD}),n.set(t.token,a),e(Object(u.d)({actions:n}))}),[n,e]),s=Object(l.useCallback)((t=>{const a=[...n.get(t.token)||[]],o=a.findIndex((e=>e.neutralizeType===t.neutralizeType));a.splice(o,1,{...t,type:u.a.ADD}),n.set(t.token,a),e(Object(u.d)({actions:n}))}),[n,e]),d=Object(l.useCallback)(((t,a)=>{const o=[...n.get(t)||[]].filter((e=>e.neutralizeType!==a));n.set(t,o),e(Object(u.d)({actions:n}))}),[e,n]),b=Object(l.useMemo)((()=>{const e=new Map;return t.forEach(((t,n)=>{e.set(n,t.map((e=>e.tokenType)))})),e}),[t]),j=Object(l.useMemo)((()=>Array.from(t.values()).flat()),[t]),p=Object(l.useMemo)((()=>{const e={};return j.forEach((t=>{t.tokenType!==u.b.SUPPLY&&t.tokenType!==u.b.WithDraw||(e[t.token]=t.amount)})),e}),[j]),m=Object(l.useMemo)((()=>{let e=0;return j.forEach((t=>{t.tokenType===u.b.SHORT&&(e=t.amount)})),e}),[j]),x=Object(l.useMemo)((()=>{let e=0;return j.forEach((t=>{t.tokenType===u.b.NEUTRALIZE&&(e+=t.amount)})),e}),[j]),h=Object(l.useMemo)((()=>{let e=0;return j.forEach((t=>{t.tokenType===u.b.SUPPLY&&(e+=t.amount)})),e}),[j]),g=Object(l.useMemo)((()=>{const e=new Map;return t.forEach((t=>{const n=t.filter((e=>e.tokenType===u.b.SUPPLY))[0];n&&e.set(n.token,n.amount)})),e}),[t]);return{addPendingAction:o,clearAllPendingAction:r,deletePendingAction:i,updatePendingAction:c,deleteNeutralizePendingAction:d,updateNeutralizePendingAction:s,pendingTokenTypes:b,pendingActions:t,pendingActionList:j,tokenAmount:p,shortAmount:m,supplyAmount:g,supplyAllAmount:h,neutralizeAmount:x}}function x(){const{rateInfo:e,activeTab:t,activeInfo:n}=Object(a.c)((e=>e.short)),o=Object(a.b)();return{rateInfo:e,onChangeCollateralIndex:Object(l.useCallback)((e=>{let{ratio:t,coverage:n}=e;o(Object(u.i)({rateInfo:{rate:t,coverage:n}}))}),[o]),activeTab:t,activeInfo:n}}},491:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var a=n(28),o=n(1),i=n(14),l=n(16),r=n(70),c=n(110);function s(){const{active:e}=Object(a.b)(),{signer:t}=Object(c.a)();return{onCheckApprove:Object(o.useCallback)((async(n,a,o)=>{if(e)try{const e=Object(l.b)(t,r,a);if(e){return await e.allowance(n,o)}}catch(i){return console.error("Failed to check approval",i),null}return null}),[e,t])}}function d(e,t){const{active:n,library:c,chainId:s}=Object(a.b)();return{handleApprove:Object(o.useCallback)((async a=>{if(n&&s){const n=Object(l.e)(c,e),o=Object(l.b)(n,r,t&&"object"===typeof t?t[s]:t);if(o)return o.approve(a,i.ethers.constants.MaxUint256)}return null}),[n,s,c,e,t])}}},540:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const a={days:10,ratio:110},o={days:20,ratio:120}}}]);
//# sourceMappingURL=18.6ace95c7.chunk.js.map